<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="local-6989586621679095625"><span id="local-6989586621679095626"></span></span><span class="hs-comment">-- |</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- Module      : Reddit.Auth</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Description : Functions for authentication and token parsing.</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Copyright   : (c) Penelope Yong 2023</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- License     : MIT</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Maintainer  : penelopeysm@gmail.com</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Stability   : experimental</span><span>
</span><span id="line-8"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Reddit.Auth</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Reddit.Auth.html#Credentials"><span class="hs-identifier">Credentials</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reddit.Auth.html#Token"><span class="hs-identifier">Token</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Reddit.Auth.html#getToken"><span class="hs-identifier">getToken</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/bytestring-0.11.4.0/src"><span class="hs-identifier">Data.ByteString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/bytestring-0.11.4.0/src"><span class="hs-identifier">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/text-1.2.5.0/src"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/text-1.2.5.0/src"><span class="hs-identifier">Text</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/text-1.2.5.0/src"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/text-1.2.5.0/src"><span class="hs-identifier">Data.Text.Encoding</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TE</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/time-1.11.1.1/src"><span class="hs-identifier">Data.Time.Clock</span></a></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Network.HTTP.Req</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Reddit.Types.html"><span class="hs-identifier">Reddit.Types</span></a></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-comment">-- | A record containing the credentials needed to authenticate with the OAuth2</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- API.</span><span>
</span><span id="line-22"></span><span class="hs-keyword">data</span><span> </span><span id="Credentials"><span class="annot"><a href="Reddit.Auth.html#Credentials"><span class="hs-identifier hs-var">Credentials</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Credentials"><span class="annot"><a href="Reddit.Auth.html#Credentials"><span class="hs-identifier hs-var">Credentials</span></a></span></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="username"><span class="annot"><span class="annottext">Credentials -&gt; Text
</span><a href="Reddit.Auth.html#username"><span class="hs-identifier hs-var hs-var">username</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span id="password"><span class="annot"><span class="annottext">Credentials -&gt; Text
</span><a href="Reddit.Auth.html#password"><span class="hs-identifier hs-var hs-var">password</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>    </span><span id="clientID"><span class="annot"><span class="annottext">Credentials -&gt; Text
</span><a href="Reddit.Auth.html#clientID"><span class="hs-identifier hs-var hs-var">clientID</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>    </span><span id="clientSecret"><span class="annot"><span class="annottext">Credentials -&gt; Text
</span><a href="Reddit.Auth.html#clientSecret"><span class="hs-identifier hs-var hs-var">clientSecret</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-comment">-- * OAuth2 scopes</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-keyword">data</span><span> </span><span id="Scope"><span class="annot"><a href="Reddit.Auth.html#Scope"><span class="hs-identifier hs-var">Scope</span></a></span></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="ScopeCreddits"><span class="annot"><a href="Reddit.Auth.html#ScopeCreddits"><span class="hs-identifier hs-var">ScopeCreddits</span></a></span></span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ScopeModNote"><span class="annot"><a href="Reddit.Auth.html#ScopeModNote"><span class="hs-identifier hs-var">ScopeModNote</span></a></span></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ScopeModContributors"><span class="annot"><a href="Reddit.Auth.html#ScopeModContributors"><span class="hs-identifier hs-var">ScopeModContributors</span></a></span></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ScopeModMail"><span class="annot"><a href="Reddit.Auth.html#ScopeModMail"><span class="hs-identifier hs-var">ScopeModMail</span></a></span></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ScopeModConfig"><span class="annot"><a href="Reddit.Auth.html#ScopeModConfig"><span class="hs-identifier hs-var">ScopeModConfig</span></a></span></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ScopeSubscribe"><span class="annot"><a href="Reddit.Auth.html#ScopeSubscribe"><span class="hs-identifier hs-var">ScopeSubscribe</span></a></span></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ScopeStructuredStyles"><span class="annot"><a href="Reddit.Auth.html#ScopeStructuredStyles"><span class="hs-identifier hs-var">ScopeStructuredStyles</span></a></span></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ScopeVote"><span class="annot"><a href="Reddit.Auth.html#ScopeVote"><span class="hs-identifier hs-var">ScopeVote</span></a></span></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ScopeWikiEdit"><span class="annot"><a href="Reddit.Auth.html#ScopeWikiEdit"><span class="hs-identifier hs-var">ScopeWikiEdit</span></a></span></span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ScopeMySubreddits"><span class="annot"><a href="Reddit.Auth.html#ScopeMySubreddits"><span class="hs-identifier hs-var">ScopeMySubreddits</span></a></span></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ScopeSubmit"><span class="annot"><a href="Reddit.Auth.html#ScopeSubmit"><span class="hs-identifier hs-var">ScopeSubmit</span></a></span></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ScopeModLog"><span class="annot"><a href="Reddit.Auth.html#ScopeModLog"><span class="hs-identifier hs-var">ScopeModLog</span></a></span></span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ScopeModPosts"><span class="annot"><a href="Reddit.Auth.html#ScopeModPosts"><span class="hs-identifier hs-var">ScopeModPosts</span></a></span></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ScopeModFlair"><span class="annot"><a href="Reddit.Auth.html#ScopeModFlair"><span class="hs-identifier hs-var">ScopeModFlair</span></a></span></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ScopeSave"><span class="annot"><a href="Reddit.Auth.html#ScopeSave"><span class="hs-identifier hs-var">ScopeSave</span></a></span></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ScopeModOthers"><span class="annot"><a href="Reddit.Auth.html#ScopeModOthers"><span class="hs-identifier hs-var">ScopeModOthers</span></a></span></span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ScopeRead"><span class="annot"><a href="Reddit.Auth.html#ScopeRead"><span class="hs-identifier hs-var">ScopeRead</span></a></span></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ScopePrivateMessages"><span class="annot"><a href="Reddit.Auth.html#ScopePrivateMessages"><span class="hs-identifier hs-var">ScopePrivateMessages</span></a></span></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ScopeReport"><span class="annot"><a href="Reddit.Auth.html#ScopeReport"><span class="hs-identifier hs-var">ScopeReport</span></a></span></span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ScopeIdentity"><span class="annot"><a href="Reddit.Auth.html#ScopeIdentity"><span class="hs-identifier hs-var">ScopeIdentity</span></a></span></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ScopeLiveManage"><span class="annot"><a href="Reddit.Auth.html#ScopeLiveManage"><span class="hs-identifier hs-var">ScopeLiveManage</span></a></span></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ScopeAccount"><span class="annot"><a href="Reddit.Auth.html#ScopeAccount"><span class="hs-identifier hs-var">ScopeAccount</span></a></span></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ScopeModTraffic"><span class="annot"><a href="Reddit.Auth.html#ScopeModTraffic"><span class="hs-identifier hs-var">ScopeModTraffic</span></a></span></span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ScopeWikiRead"><span class="annot"><a href="Reddit.Auth.html#ScopeWikiRead"><span class="hs-identifier hs-var">ScopeWikiRead</span></a></span></span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ScopeEdit"><span class="annot"><a href="Reddit.Auth.html#ScopeEdit"><span class="hs-identifier hs-var">ScopeEdit</span></a></span></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ScopeModWiki"><span class="annot"><a href="Reddit.Auth.html#ScopeModWiki"><span class="hs-identifier hs-var">ScopeModWiki</span></a></span></span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ScopeModSelf"><span class="annot"><a href="Reddit.Auth.html#ScopeModSelf"><span class="hs-identifier hs-var">ScopeModSelf</span></a></span></span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ScopeHistory"><span class="annot"><a href="Reddit.Auth.html#ScopeHistory"><span class="hs-identifier hs-var">ScopeHistory</span></a></span></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ScopeFlair"><span class="annot"><a href="Reddit.Auth.html#ScopeFlair"><span class="hs-identifier hs-var">ScopeFlair</span></a></span></span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679095453"><span id="local-6989586621679095455"><span class="annot"><span class="annottext">Scope -&gt; Scope -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Scope -&gt; Scope -&gt; Bool
$c/= :: Scope -&gt; Scope -&gt; Bool
== :: Scope -&gt; Scope -&gt; Bool
$c== :: Scope -&gt; Scope -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679095433"><span id="local-6989586621679095435"><span id="local-6989586621679095438"><span id="local-6989586621679095441"><span id="local-6989586621679095444"><span id="local-6989586621679095446"><span id="local-6989586621679095448"><span class="annot"><span class="annottext">Eq Scope
Scope -&gt; Scope -&gt; Bool
Scope -&gt; Scope -&gt; Ordering
Scope -&gt; Scope -&gt; Scope
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: Scope -&gt; Scope -&gt; Scope
$cmin :: Scope -&gt; Scope -&gt; Scope
max :: Scope -&gt; Scope -&gt; Scope
$cmax :: Scope -&gt; Scope -&gt; Scope
&gt;= :: Scope -&gt; Scope -&gt; Bool
$c&gt;= :: Scope -&gt; Scope -&gt; Bool
&gt; :: Scope -&gt; Scope -&gt; Bool
$c&gt; :: Scope -&gt; Scope -&gt; Bool
&lt;= :: Scope -&gt; Scope -&gt; Bool
$c&lt;= :: Scope -&gt; Scope -&gt; Bool
&lt; :: Scope -&gt; Scope -&gt; Bool
$c&lt; :: Scope -&gt; Scope -&gt; Bool
compare :: Scope -&gt; Scope -&gt; Ordering
$ccompare :: Scope -&gt; Scope -&gt; Ordering
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679095390"><span id="local-6989586621679095392"><span id="local-6989586621679095396"><span id="local-6989586621679095400"><span id="local-6989586621679095402"><span id="local-6989586621679095416"><span id="local-6989586621679095422"><span id="local-6989586621679095430"><span class="annot"><span class="annottext">Int -&gt; Scope
Scope -&gt; Int
Scope -&gt; [Scope]
Scope -&gt; Scope
Scope -&gt; Scope -&gt; [Scope]
Scope -&gt; Scope -&gt; Scope -&gt; [Scope]
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
enumFromThenTo :: Scope -&gt; Scope -&gt; Scope -&gt; [Scope]
$cenumFromThenTo :: Scope -&gt; Scope -&gt; Scope -&gt; [Scope]
enumFromTo :: Scope -&gt; Scope -&gt; [Scope]
$cenumFromTo :: Scope -&gt; Scope -&gt; [Scope]
enumFromThen :: Scope -&gt; Scope -&gt; [Scope]
$cenumFromThen :: Scope -&gt; Scope -&gt; [Scope]
enumFrom :: Scope -&gt; [Scope]
$cenumFrom :: Scope -&gt; [Scope]
fromEnum :: Scope -&gt; Int
$cfromEnum :: Scope -&gt; Int
toEnum :: Int -&gt; Scope
$ctoEnum :: Int -&gt; Scope
pred :: Scope -&gt; Scope
$cpred :: Scope -&gt; Scope
succ :: Scope -&gt; Scope
$csucc :: Scope -&gt; Scope
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></a></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679095385"><span id="local-6989586621679095387"><span class="annot"><span class="annottext">Scope
forall a. a -&gt; a -&gt; Bounded a
maxBound :: Scope
$cmaxBound :: Scope
minBound :: Scope
$cminBound :: Scope
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Bounded</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679095378"><span id="local-6989586621679095380"><span id="local-6989586621679095382"><span class="annot"><span class="annottext">Int -&gt; Scope -&gt; ShowS
[Scope] -&gt; ShowS
Scope -&gt; [Char]
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Scope] -&gt; ShowS
$cshowList :: [Scope] -&gt; ShowS
show :: Scope -&gt; [Char]
$cshow :: Scope -&gt; [Char]
showsPrec :: Int -&gt; Scope -&gt; ShowS
$cshowsPrec :: Int -&gt; Scope -&gt; ShowS
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="annot"><a href="Reddit.Auth.html#parseScopes"><span class="hs-identifier hs-type">parseScopes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">S.Set</span></a></span><span> </span><span class="annot"><a href="Reddit.Auth.html#Scope"><span class="hs-identifier hs-type">Scope</span></a></span><span>
</span><span id="line-64"></span><span id="parseScopes"><span class="annot"><span class="annottext">parseScopes :: Text -&gt; Set Scope
</span><a href="Reddit.Auth.html#parseScopes"><span class="hs-identifier hs-var hs-var">parseScopes</span></a></span></span><span> </span><span id="local-6989586621679095375"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679095375"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Text -&gt; [Text]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-var">T.split</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679095373"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679095373"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679095373"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">','</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679095373"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679095375"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.empty</span></a></span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621679095370"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679095370"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679095370"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-67"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.empty</span></a></span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.fromList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall a. Bounded a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">minBound</span></a></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">forall a. Bounded a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maxBound</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- All scopes</span><span>
</span><span id="line-69"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;account&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeAccount"><span class="hs-identifier hs-var">ScopeAccount</span></a></span><span>
</span><span id="line-70"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;creddits&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeCreddits"><span class="hs-identifier hs-var">ScopeCreddits</span></a></span><span>
</span><span id="line-71"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;edit&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeEdit"><span class="hs-identifier hs-var">ScopeEdit</span></a></span><span>
</span><span id="line-72"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;flair&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeFlair"><span class="hs-identifier hs-var">ScopeFlair</span></a></span><span>
</span><span id="line-73"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;history&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeHistory"><span class="hs-identifier hs-var">ScopeHistory</span></a></span><span>
</span><span id="line-74"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;identity&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeIdentity"><span class="hs-identifier hs-var">ScopeIdentity</span></a></span><span>
</span><span id="line-75"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;livemanage&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeLiveManage"><span class="hs-identifier hs-var">ScopeLiveManage</span></a></span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;modconfig&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModConfig"><span class="hs-identifier hs-var">ScopeModConfig</span></a></span><span>
</span><span id="line-77"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;modcontributors&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModContributors"><span class="hs-identifier hs-var">ScopeModContributors</span></a></span><span>
</span><span id="line-78"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;modflair&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModFlair"><span class="hs-identifier hs-var">ScopeModFlair</span></a></span><span>
</span><span id="line-79"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;modlog&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModLog"><span class="hs-identifier hs-var">ScopeModLog</span></a></span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;modmail&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModMail"><span class="hs-identifier hs-var">ScopeModMail</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;modnote&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModNote"><span class="hs-identifier hs-var">ScopeModNote</span></a></span><span>
</span><span id="line-82"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;modothers&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModOthers"><span class="hs-identifier hs-var">ScopeModOthers</span></a></span><span>
</span><span id="line-83"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;modposts&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModPosts"><span class="hs-identifier hs-var">ScopeModPosts</span></a></span><span>
</span><span id="line-84"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;modself&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModSelf"><span class="hs-identifier hs-var">ScopeModSelf</span></a></span><span>
</span><span id="line-85"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;modtraffic&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModTraffic"><span class="hs-identifier hs-var">ScopeModTraffic</span></a></span><span>
</span><span id="line-86"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;modwiki&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModWiki"><span class="hs-identifier hs-var">ScopeModWiki</span></a></span><span>
</span><span id="line-87"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;mysubreddits&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeMySubreddits"><span class="hs-identifier hs-var">ScopeMySubreddits</span></a></span><span>
</span><span id="line-88"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;privatemessages&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopePrivateMessages"><span class="hs-identifier hs-var">ScopePrivateMessages</span></a></span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;read&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeRead"><span class="hs-identifier hs-var">ScopeRead</span></a></span><span>
</span><span id="line-90"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;report&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeReport"><span class="hs-identifier hs-var">ScopeReport</span></a></span><span>
</span><span id="line-91"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;save&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeSave"><span class="hs-identifier hs-var">ScopeSave</span></a></span><span>
</span><span id="line-92"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;structuredstyles&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeStructuredStyles"><span class="hs-identifier hs-var">ScopeStructuredStyles</span></a></span><span>
</span><span id="line-93"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;submit&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeSubmit"><span class="hs-identifier hs-var">ScopeSubmit</span></a></span><span>
</span><span id="line-94"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;subscribe&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeSubscribe"><span class="hs-identifier hs-var">ScopeSubscribe</span></a></span><span>
</span><span id="line-95"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;vote&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeVote"><span class="hs-identifier hs-var">ScopeVote</span></a></span><span>
</span><span id="line-96"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;wikiedit&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeWikiEdit"><span class="hs-identifier hs-var">ScopeWikiEdit</span></a></span><span>
</span><span id="line-97"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;wikiread&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeWikiRead"><span class="hs-identifier hs-var">ScopeWikiRead</span></a></span><span>
</span><span id="line-98"></span><span>  </span><span id="local-6989586621679095365"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679095365"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mconcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Set Scope
</span><a href="Reddit.Auth.html#parseScopes"><span class="hs-identifier hs-var">parseScopes</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679095365"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="annot"><a href="Reddit.Auth.html#showScopes"><span class="hs-identifier hs-type">showScopes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">S.Set</span></a></span><span> </span><span class="annot"><a href="Reddit.Auth.html#Scope"><span class="hs-identifier hs-type">Scope</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-101"></span><span id="showScopes"><span class="annot"><span class="annottext">showScopes :: Set Scope -&gt; Text
</span><a href="Reddit.Auth.html#showScopes"><span class="hs-identifier hs-var hs-var">showScopes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; Text
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-var">T.intercalate</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall {a}. IsString a =&gt; Scope -&gt; a
</span><a href="#local-6989586621679095361"><span class="hs-identifier hs-var">showOneScope</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.toList</span></a></span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-103"></span><span>    </span><span id="local-6989586621679095361"><span class="annot"><span class="annottext">showOneScope :: Scope -&gt; a
</span><a href="#local-6989586621679095361"><span class="hs-identifier hs-var hs-var">showOneScope</span></a></span></span><span> </span><span id="local-6989586621679095329"><span class="annot"><span class="annottext">Scope
</span><a href="#local-6989586621679095329"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="#local-6989586621679095329"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-104"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeAccount"><span class="hs-identifier hs-var">ScopeAccount</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;account&quot;</span></span><span>
</span><span id="line-105"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeCreddits"><span class="hs-identifier hs-var">ScopeCreddits</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;creddits&quot;</span></span><span>
</span><span id="line-106"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeEdit"><span class="hs-identifier hs-var">ScopeEdit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;edit&quot;</span></span><span>
</span><span id="line-107"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeFlair"><span class="hs-identifier hs-var">ScopeFlair</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;flair&quot;</span></span><span>
</span><span id="line-108"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeHistory"><span class="hs-identifier hs-var">ScopeHistory</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;history&quot;</span></span><span>
</span><span id="line-109"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeIdentity"><span class="hs-identifier hs-var">ScopeIdentity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;identity&quot;</span></span><span>
</span><span id="line-110"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeLiveManage"><span class="hs-identifier hs-var">ScopeLiveManage</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;livemanage&quot;</span></span><span>
</span><span id="line-111"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModConfig"><span class="hs-identifier hs-var">ScopeModConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;modconfig&quot;</span></span><span>
</span><span id="line-112"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModContributors"><span class="hs-identifier hs-var">ScopeModContributors</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;modcontributors&quot;</span></span><span>
</span><span id="line-113"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModFlair"><span class="hs-identifier hs-var">ScopeModFlair</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;modflair&quot;</span></span><span>
</span><span id="line-114"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModLog"><span class="hs-identifier hs-var">ScopeModLog</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;modlog&quot;</span></span><span>
</span><span id="line-115"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModMail"><span class="hs-identifier hs-var">ScopeModMail</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;modmail&quot;</span></span><span>
</span><span id="line-116"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModNote"><span class="hs-identifier hs-var">ScopeModNote</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;modnote&quot;</span></span><span>
</span><span id="line-117"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModOthers"><span class="hs-identifier hs-var">ScopeModOthers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;modothers&quot;</span></span><span>
</span><span id="line-118"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModPosts"><span class="hs-identifier hs-var">ScopeModPosts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;modposts&quot;</span></span><span>
</span><span id="line-119"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModSelf"><span class="hs-identifier hs-var">ScopeModSelf</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;modself&quot;</span></span><span>
</span><span id="line-120"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModTraffic"><span class="hs-identifier hs-var">ScopeModTraffic</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;modtraffic&quot;</span></span><span>
</span><span id="line-121"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModWiki"><span class="hs-identifier hs-var">ScopeModWiki</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;modwiki&quot;</span></span><span>
</span><span id="line-122"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeMySubreddits"><span class="hs-identifier hs-var">ScopeMySubreddits</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;mysubreddits&quot;</span></span><span>
</span><span id="line-123"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopePrivateMessages"><span class="hs-identifier hs-var">ScopePrivateMessages</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;privatemessages&quot;</span></span><span>
</span><span id="line-124"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeRead"><span class="hs-identifier hs-var">ScopeRead</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;read&quot;</span></span><span>
</span><span id="line-125"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeReport"><span class="hs-identifier hs-var">ScopeReport</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;report&quot;</span></span><span>
</span><span id="line-126"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeSave"><span class="hs-identifier hs-var">ScopeSave</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;save&quot;</span></span><span>
</span><span id="line-127"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeStructuredStyles"><span class="hs-identifier hs-var">ScopeStructuredStyles</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;structuredstyles&quot;</span></span><span>
</span><span id="line-128"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeSubmit"><span class="hs-identifier hs-var">ScopeSubmit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;submit&quot;</span></span><span>
</span><span id="line-129"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeSubscribe"><span class="hs-identifier hs-var">ScopeSubscribe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;subscribe&quot;</span></span><span>
</span><span id="line-130"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeVote"><span class="hs-identifier hs-var">ScopeVote</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;vote&quot;</span></span><span>
</span><span id="line-131"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeWikiEdit"><span class="hs-identifier hs-var">ScopeWikiEdit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;wikiedit&quot;</span></span><span>
</span><span id="line-132"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeWikiRead"><span class="hs-identifier hs-var">ScopeWikiRead</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;wikiread&quot;</span></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="hs-comment">-- * Access tokens</span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="hs-comment">-- | The raw JSON representation of an access token, as returned by Reddit.</span><span>
</span><span id="line-137"></span><span class="hs-keyword">data</span><span> </span><span id="TokenInternal"><span class="annot"><a href="Reddit.Auth.html#TokenInternal"><span class="hs-identifier hs-var">TokenInternal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TokenInternal"><span class="annot"><a href="Reddit.Auth.html#TokenInternal"><span class="hs-identifier hs-var">TokenInternal</span></a></span></span><span>
</span><span id="line-138"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_access_token"><span class="annot"><span class="annottext">TokenInternal -&gt; Text
</span><a href="Reddit.Auth.html#_access_token"><span class="hs-identifier hs-var hs-var">_access_token</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-139"></span><span>    </span><span id="_token_type"><span class="annot"><span class="annottext">TokenInternal -&gt; Text
</span><a href="Reddit.Auth.html#_token_type"><span class="hs-identifier hs-var hs-var">_token_type</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-140"></span><span>    </span><span id="_expires_in"><span class="annot"><span class="annottext">TokenInternal -&gt; Int
</span><a href="Reddit.Auth.html#_expires_in"><span class="hs-identifier hs-var hs-var">_expires_in</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-141"></span><span>    </span><span id="_scope"><span class="annot"><span class="annottext">TokenInternal -&gt; Text
</span><a href="Reddit.Auth.html#_scope"><span class="hs-identifier hs-var hs-var">_scope</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679095321"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Reddit.Auth.html#TokenInternal"><span class="hs-identifier hs-type">TokenInternal</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-145"></span><span>  </span><span id="local-6989586621679095302"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser TokenInternal
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Object</span></span><span> </span><span id="local-6989586621679095299"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679095299"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-146"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Int -&gt; Text -&gt; TokenInternal
</span><a href="Reddit.Auth.html#TokenInternal"><span class="hs-identifier hs-var">TokenInternal</span></a></span><span>
</span><span id="line-147"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679095299"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-148"></span><span>        </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;access_token&quot;</span></span><span>
</span><span id="line-149"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679095299"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-150"></span><span>        </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;token_type&quot;</span></span><span>
</span><span id="line-151"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679095299"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-152"></span><span>        </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;expires_in&quot;</span></span><span>
</span><span id="line-153"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679095299"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-154"></span><span>        </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;scope&quot;</span></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="hs-comment">-- | Obtain a raw token using credentials.</span><span>
</span><span id="line-157"></span><span class="annot"><a href="Reddit.Auth.html#getTokenInternal"><span class="hs-identifier hs-type">getTokenInternal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reddit.Auth.html#Credentials"><span class="hs-identifier hs-type">Credentials</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/bytestring-0.11.4.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Reddit.Auth.html#TokenInternal"><span class="hs-identifier hs-type">TokenInternal</span></a></span><span>
</span><span id="line-158"></span><span id="getTokenInternal"><span class="annot"><span class="annottext">getTokenInternal :: Credentials -&gt; ByteString -&gt; IO TokenInternal
</span><a href="Reddit.Auth.html#getTokenInternal"><span class="hs-identifier hs-var hs-var">getTokenInternal</span></a></span></span><span> </span><span id="local-6989586621679095295"><span class="annot"><span class="annottext">Credentials
</span><a href="#local-6989586621679095295"><span class="hs-identifier hs-var">creds</span></a></span></span><span> </span><span id="local-6989586621679095294"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095294"><span class="hs-identifier hs-var">ua</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; HttpConfig -&gt; Req a -&gt; m a
</span><span class="hs-identifier hs-var">runReq</span></span><span> </span><span class="annot"><span class="annottext">HttpConfig
</span><span class="hs-identifier hs-var">defaultHttpConfig</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679095287"><span class="annot"><span class="annottext">uri :: Url 'Https
</span><a href="#local-6989586621679095287"><span class="hs-identifier hs-var hs-var">uri</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Url 'Https
</span><span class="hs-identifier hs-var">https</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;www.reddit.com&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (scheme :: Scheme). Url scheme -&gt; Text -&gt; Url scheme
</span><span class="hs-operator hs-var">/:</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;api&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (scheme :: Scheme). Url scheme -&gt; Text -&gt; Url scheme
</span><span class="hs-operator hs-var">/:</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;v1&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (scheme :: Scheme). Url scheme -&gt; Text -&gt; Url scheme
</span><span class="hs-operator hs-var">/:</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;access_token&quot;</span></span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679095284"><span class="annot"><span class="annottext">body :: ReqBodyUrlEnc
</span><a href="#local-6989586621679095284"><span class="hs-identifier hs-var hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-161"></span><span>        </span><span class="annot"><span class="annottext">FormUrlEncodedParam -&gt; ReqBodyUrlEnc
</span><span class="hs-identifier hs-var">ReqBodyUrlEnc</span></span><span>
</span><span id="line-162"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;grant_type&quot;</span></span><span>
</span><span id="line-163"></span><span>              </span><span class="annot"><span class="annottext">forall param a.
(QueryParam param, ToHttpApiData a) =&gt;
Text -&gt; a -&gt; param
</span><span class="hs-operator hs-var">=:</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;password&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>              </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;username&quot;</span></span><span>
</span><span id="line-165"></span><span>                </span><span class="annot"><span class="annottext">forall param a.
(QueryParam param, ToHttpApiData a) =&gt;
Text -&gt; a -&gt; param
</span><span class="hs-operator hs-var">=:</span></span><span> </span><span class="annot"><span class="annottext">Credentials
</span><a href="#local-6989586621679095295"><span class="hs-identifier hs-var">creds</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">username</span><span>
</span><span id="line-166"></span><span>              </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;password&quot;</span></span><span>
</span><span id="line-167"></span><span>                </span><span class="annot"><span class="annottext">forall param a.
(QueryParam param, ToHttpApiData a) =&gt;
Text -&gt; a -&gt; param
</span><span class="hs-operator hs-var">=:</span></span><span> </span><span class="annot"><span class="annottext">Credentials
</span><a href="#local-6989586621679095295"><span class="hs-identifier hs-var">creds</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">password</span><span>
</span><span id="line-168"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679095281"><span class="annot"><span class="annottext">req_params :: Option 'Https
</span><a href="#local-6989586621679095281"><span class="hs-identifier hs-var hs-var">req_params</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-170"></span><span>        </span><span class="annot"><span class="annottext">forall (scheme :: Scheme).
ByteString -&gt; ByteString -&gt; Option scheme
</span><span class="hs-identifier hs-var">header</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;user-agent&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095294"><span class="hs-identifier hs-var">ua</span></a></span><span>
</span><span id="line-171"></span><span>          </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Option 'Https
</span><span class="hs-identifier hs-var">basicAuth</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-var">TE.encodeUtf8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credentials -&gt; Text
</span><a href="Reddit.Auth.html#clientID"><span class="hs-identifier hs-var">clientID</span></a></span><span> </span><span class="annot"><span class="annottext">Credentials
</span><a href="#local-6989586621679095295"><span class="hs-identifier hs-var">creds</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-var">TE.encodeUtf8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credentials -&gt; Text
</span><a href="Reddit.Auth.html#clientSecret"><span class="hs-identifier hs-var">clientSecret</span></a></span><span> </span><span class="annot"><span class="annottext">Credentials
</span><a href="#local-6989586621679095295"><span class="hs-identifier hs-var">creds</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>  </span><span id="local-6989586621679095277"><span class="annot"><span class="annottext">LbsResponse
</span><a href="#local-6989586621679095277"><span class="hs-identifier hs-var">response</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) method body response (scheme :: Scheme).
(MonadHttp m, HttpMethod method, HttpBody body,
 HttpResponse response,
 HttpBodyAllowed (AllowsBody method) (ProvidesBody body)) =&gt;
method
-&gt; Url scheme
-&gt; body
-&gt; Proxy response
-&gt; Option scheme
-&gt; m response
</span><span class="hs-identifier hs-var">req</span></span><span> </span><span class="annot"><span class="annottext">POST
</span><span class="hs-identifier hs-var">POST</span></span><span> </span><span class="annot"><span class="annottext">Url 'Https
</span><a href="#local-6989586621679095287"><span class="hs-identifier hs-var">uri</span></a></span><span> </span><span class="annot"><span class="annottext">ReqBodyUrlEnc
</span><a href="#local-6989586621679095284"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy LbsResponse
</span><span class="hs-identifier hs-var">lbsResponse</span></span><span> </span><span class="annot"><span class="annottext">Option 'Https
</span><a href="#local-6989586621679095281"><span class="hs-identifier hs-var">req_params</span></a></span><span>
</span><span id="line-173"></span><span>  </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *).
(FromJSON a, MonadThrow m) =&gt;
ByteString -&gt; m a
</span><span class="hs-identifier hs-var">throwDecode</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall response.
HttpResponse response =&gt;
response -&gt; HttpResponseBody response
</span><span class="hs-identifier hs-var">responseBody</span></span><span> </span><span class="annot"><span class="annottext">LbsResponse
</span><a href="#local-6989586621679095277"><span class="hs-identifier hs-var">response</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="hs-comment">-- | A parsed value of a Reddit access token.</span><span>
</span><span id="line-176"></span><span class="hs-keyword">data</span><span> </span><span id="Token"><span class="annot"><a href="Reddit.Auth.html#Token"><span class="hs-identifier hs-var">Token</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Token"><span class="annot"><a href="Reddit.Auth.html#Token"><span class="hs-identifier hs-var">Token</span></a></span></span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="token"><span class="annot"><span class="annottext">Token -&gt; ByteString
</span><a href="Reddit.Auth.html#token"><span class="hs-identifier hs-var hs-var">token</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/bytestring-0.11.4.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-178"></span><span>    </span><span id="token_type"><span class="annot"><span class="annottext">Token -&gt; ByteString
</span><a href="Reddit.Auth.html#token_type"><span class="hs-identifier hs-var hs-var">token_type</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/bytestring-0.11.4.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-179"></span><span>    </span><span id="expires_at"><span class="annot"><span class="annottext">Token -&gt; UTCTime
</span><a href="Reddit.Auth.html#expires_at"><span class="hs-identifier hs-var hs-var">expires_at</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/time-1.11.1.1/src"><span class="hs-identifier hs-type">UTCTime</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-180"></span><span>    </span><span id="scopes"><span class="annot"><span class="annottext">Token -&gt; Set Scope
</span><a href="Reddit.Auth.html#scopes"><span class="hs-identifier hs-var hs-var">scopes</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">S.Set</span></a></span><span> </span><span class="annot"><a href="Reddit.Auth.html#Scope"><span class="hs-identifier hs-type">Scope</span></a></span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679095252"><span id="local-6989586621679095254"><span id="local-6989586621679095265"><span class="annot"><span class="annottext">Int -&gt; Token -&gt; ShowS
[Token] -&gt; ShowS
Token -&gt; [Char]
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Token] -&gt; ShowS
$cshowList :: [Token] -&gt; ShowS
show :: Token -&gt; [Char]
$cshow :: Token -&gt; [Char]
showsPrec :: Int -&gt; Token -&gt; ShowS
$cshowsPrec :: Int -&gt; Token -&gt; ShowS
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="annot"><a href="Reddit.Auth.html#parseToken"><span class="hs-identifier hs-type">parseToken</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reddit.Auth.html#TokenInternal"><span class="hs-identifier hs-type">TokenInternal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Reddit.Auth.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-185"></span><span id="parseToken"><span class="annot"><span class="annottext">parseToken :: TokenInternal -&gt; IO Token
</span><a href="Reddit.Auth.html#parseToken"><span class="hs-identifier hs-var hs-var">parseToken</span></a></span></span><span> </span><span id="local-6989586621679095250"><span class="annot"><span class="annottext">TokenInternal
</span><a href="#local-6989586621679095250"><span class="hs-identifier hs-var">tokenInternal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-186"></span><span>  </span><span id="local-6989586621679095249"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679095249"><span class="hs-identifier hs-var">currentTime</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO UTCTime
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/time-1.11.1.1/src"><span class="hs-identifier hs-var">getCurrentTime</span></a></span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679095247"><span class="annot"><span class="annottext">seconds :: NominalDiffTime
</span><a href="#local-6989586621679095247"><span class="hs-identifier hs-var hs-var">seconds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pico -&gt; NominalDiffTime
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/time-1.11.1.1/src"><span class="hs-identifier hs-var">secondsToNominalDiffTime</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (Real a, Fractional b) =&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">realToFrac</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TokenInternal
</span><a href="#local-6989586621679095250"><span class="hs-identifier hs-var">tokenInternal</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">_expires_in</span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-comment">-- Insert 10 second buffer time just in case there's lots of time between</span><span>
</span><span id="line-189"></span><span>  </span><span class="hs-comment">-- tokenInternal and currentTime being obtained.</span><span>
</span><span id="line-190"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679095245"><span class="annot"><span class="annottext">expires_at :: UTCTime
</span><a href="#local-6989586621679095245"><span class="hs-identifier hs-var hs-var">expires_at</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; UTCTime -&gt; UTCTime
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/time-1.11.1.1/src"><span class="hs-identifier hs-var">addUTCTime</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="#local-6989586621679095247"><span class="hs-identifier hs-var">seconds</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679095249"><span class="hs-identifier hs-var">currentTime</span></a></span><span>
</span><span id="line-191"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-192"></span><span>    </span><span class="annot"><a href="Reddit.Auth.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-193"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">token :: ByteString
</span><a href="Reddit.Auth.html#token"><span class="hs-identifier hs-var">token</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-var">TE.encodeUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">TokenInternal
</span><a href="#local-6989586621679095250"><span class="hs-identifier hs-var">tokenInternal</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">_access_token</span><span class="hs-special">,</span><span>
</span><span id="line-194"></span><span>        </span><span class="annot"><span class="annottext">token_type :: ByteString
</span><a href="Reddit.Auth.html#token_type"><span class="hs-identifier hs-var">token_type</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-var">TE.encodeUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">TokenInternal
</span><a href="#local-6989586621679095250"><span class="hs-identifier hs-var">tokenInternal</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">_token_type</span><span class="hs-special">,</span><span>
</span><span id="line-195"></span><span>        </span><span class="annot"><span class="annottext">scopes :: Set Scope
</span><a href="Reddit.Auth.html#scopes"><span class="hs-identifier hs-var">scopes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Set Scope
</span><a href="Reddit.Auth.html#parseScopes"><span class="hs-identifier hs-var">parseScopes</span></a></span><span> </span><span class="annot"><span class="annottext">TokenInternal
</span><a href="#local-6989586621679095250"><span class="hs-identifier hs-var">tokenInternal</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">_scope</span><span class="hs-special">,</span><span>
</span><span id="line-196"></span><span>        </span><span class="annot"><span class="annottext">expires_at :: UTCTime
</span><a href="Reddit.Auth.html#expires_at"><span class="hs-identifier hs-var">expires_at</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679095245"><span class="hs-identifier hs-var">expires_at</span></a></span><span>
</span><span id="line-197"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="annot"><a href="Reddit.Auth.html#getToken"><span class="hs-identifier hs-type">getToken</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reddit.Auth.html#Credentials"><span class="hs-identifier hs-type">Credentials</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/bytestring-0.11.4.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Reddit.Auth.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-200"></span><span id="getToken"><span class="annot"><span class="annottext">getToken :: Credentials -&gt; ByteString -&gt; IO Token
</span><a href="Reddit.Auth.html#getToken"><span class="hs-identifier hs-var hs-var">getToken</span></a></span></span><span> </span><span id="local-6989586621679095243"><span class="annot"><span class="annottext">Credentials
</span><a href="#local-6989586621679095243"><span class="hs-identifier hs-var">creds</span></a></span></span><span> </span><span id="local-6989586621679095242"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095242"><span class="hs-identifier hs-var">ua</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Credentials -&gt; ByteString -&gt; IO TokenInternal
</span><a href="Reddit.Auth.html#getTokenInternal"><span class="hs-identifier hs-var">getTokenInternal</span></a></span><span> </span><span class="annot"><span class="annottext">Credentials
</span><a href="#local-6989586621679095243"><span class="hs-identifier hs-var">creds</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095242"><span class="hs-identifier hs-var">ua</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.7/share/doc/ghc-9.2.7/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">TokenInternal -&gt; IO Token
</span><a href="Reddit.Auth.html#parseToken"><span class="hs-identifier hs-var">parseToken</span></a></span><span>
</span><span id="line-201"></span></pre></body></html>