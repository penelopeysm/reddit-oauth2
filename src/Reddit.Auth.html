<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="local-6989586621679103145"><span id="local-6989586621679103146"></span></span><span class="hs-comment">-- |</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- Module      : Reddit.Auth</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Description : Functions for authentication and token parsing.</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Copyright   : (c) Penelope Yong 2023</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- License     : MIT</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Maintainer  : penelopeysm@gmail.com</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Stability   : experimental</span><span>
</span><span id="line-8"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Reddit.Auth</span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Reddit.Auth.html#Credentials"><span class="hs-identifier">Credentials</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><a href="Reddit.Auth.html#Token"><span class="hs-identifier">Token</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="Reddit.Auth.html#getToken"><span class="hs-identifier">getToken</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><a href="Reddit.Auth.html#AuthUrlParams"><span class="hs-identifier">AuthUrlParams</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="Reddit.Auth.html#mkRedditAuthURL"><span class="hs-identifier">mkRedditAuthURL</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Reddit.Auth.html#Scope"><span class="hs-identifier">Scope</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Reddit.Auth.html#parseScopes"><span class="hs-identifier">parseScopes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Reddit.Auth.html#showScopes"><span class="hs-identifier">showScopes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Reddit.Auth.html#allScopes"><span class="hs-identifier">allScopes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="Reddit.Auth.html#Duration"><span class="hs-identifier">Duration</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">where</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/bytestring-0.11.4.0/src"><span class="hs-identifier">Data.ByteString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/bytestring-0.11.4.0/src"><span class="hs-identifier">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">fromMaybe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier">Text</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier">Data.Text.Encoding</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TE</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/time-1.11.1.1/src"><span class="hs-identifier">Data.Time.Clock</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Network.HTTP.Req</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Text.URI</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">URI</span></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-comment">-- | The @Credentials@ type contains all the information you need to</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- authenticate with the Reddit API.</span><span>
</span><span id="line-35"></span><span class="hs-keyword">data</span><span> </span><span id="Credentials"><span class="annot"><a href="Reddit.Auth.html#Credentials"><span class="hs-identifier hs-var">Credentials</span></a></span></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | __'Resource owner' flow__</span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-comment">-- Formally, this is the 'Resource Owner Password Credentials Grant' for</span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-comment">-- OAuth 2.0, which is described in [Section 4.3 of IETF RFC</span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-comment">-- 6749](https://datatracker.ietf.org/doc/html/rfc6749#section-4.3).</span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-comment">-- To authenticate in this manner, you will need a username and password for</span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-comment">-- a Reddit account, plus a client ID and client secret associated with a</span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-comment">-- Reddit app. The username in question must be listed as a developer of the</span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-comment">-- app. You can set up a new app by:</span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-comment">-- 1. Log in using the account you want to post or query Reddit as (this</span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-comment">-- may be a bot account, for example).</span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-comment">-- 2. Navigate to &lt;https://www.reddit.com/prefs/apps&gt;</span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-comment">-- 3. Click \'create another app\' at the bottom and select the \'script\'</span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-comment">-- radio button</span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-comment">-- 4. Fill in the required details. For a personal script, the redirect URI</span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-comment">-- is not important, set it to anything you like.</span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-comment">-- 5. Take note of the app ID (a string with random characters) and the</span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-comment">-- secret (the same but longer). These become, respectively,  @clientID@ and</span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-comment">-- @clientSecret@.</span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-comment">-- 6. @username@ and @password@ are the Reddit login credentials of the</span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-comment">-- account you are using.</span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-comment">-- /Note:/ __Do NOT ever share your password or the client secret publicly!__</span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-comment">-- See also:</span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-comment">-- &lt;https://github.com/reddit-archive/reddit/wiki/OAuth2-Quick-Start-Example&gt;</span><span>
</span><span id="line-69"></span><span>    </span><span id="OwnerCredentials"><span class="annot"><a href="Reddit.Auth.html#OwnerCredentials"><span class="hs-identifier hs-var">OwnerCredentials</span></a></span></span><span>
</span><span id="line-70"></span><span>      </span><span class="hs-special">{</span><span> </span><span id="ownerUsername"><span class="annot"><span class="annottext">Credentials -&gt; Text
</span><a href="Reddit.Auth.html#ownerUsername"><span class="hs-identifier hs-var hs-var">ownerUsername</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-71"></span><span>        </span><span id="ownerPassword"><span class="annot"><span class="annottext">Credentials -&gt; Text
</span><a href="Reddit.Auth.html#ownerPassword"><span class="hs-identifier hs-var hs-var">ownerPassword</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-72"></span><span>        </span><span id="ownerClientId"><span class="annot"><span class="annottext">Credentials -&gt; Text
</span><a href="Reddit.Auth.html#ownerClientId"><span class="hs-identifier hs-var hs-var">ownerClientId</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-73"></span><span>        </span><span id="ownerClientSecret"><span class="annot"><span class="annottext">Credentials -&gt; Text
</span><a href="Reddit.Auth.html#ownerClientSecret"><span class="hs-identifier hs-var hs-var">ownerClientSecret</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-74"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | __'Code grant' flow__</span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-comment">-- Formally, this is the 'Authorisation Code Grant' for OAuth 2.0, which is</span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-comment">-- described in [Section 4.1 of IETF RFC</span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-comment">-- 6749](https://datatracker.ietf.org/doc/html/rfc6749#section-4.1).</span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-comment">-- Begin by [setting up a new Reddit app](https://www.reddit.com/prefs/apps)</span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-comment">-- in the same way as for the 'resource owner' flow above. Then:</span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-comment">-- 1. 'codeGrantClientId' and 'codeGrantClientSecret' are simply the 'app ID'</span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-comment">-- and 'app secret' from the Reddit app.</span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-comment">-- 2. 'codeGrantRedirectUri' is the redirect URI you specified when setting</span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-comment">-- up the app. Note that this must match exactly.</span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-comment">-- 3. To obtain 'codeGrantCode', you must first construct the Reddit</span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-comment">-- authentication link using 'mkRedditAuthURL'. Send your user to this link,</span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-comment">-- and they will be greeted with a Reddit page asking them to authorise your</span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-comment">-- app. When they click \'allow\', Reddit will send the user back to the</span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-comment">-- redirect URI which you specified, along with a \'code\' query parameter</span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-comment">-- in the URI. You should then parse this and set it as 'codeGrantCode'.</span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-comment">-- See also:</span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-comment">-- &lt;https://github.com/reddit-archive/reddit/wiki/OAuth2&gt;</span><span>
</span><span id="line-99"></span><span>    </span><span id="CodeGrantCredentials"><span class="annot"><a href="Reddit.Auth.html#CodeGrantCredentials"><span class="hs-identifier hs-var">CodeGrantCredentials</span></a></span></span><span>
</span><span id="line-100"></span><span>      </span><span class="hs-special">{</span><span> </span><span id="codeGrantClientId"><span class="annot"><span class="annottext">Credentials -&gt; Text
</span><a href="Reddit.Auth.html#codeGrantClientId"><span class="hs-identifier hs-var hs-var">codeGrantClientId</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-101"></span><span>        </span><span id="codeGrantClientSecret"><span class="annot"><span class="annottext">Credentials -&gt; Text
</span><a href="Reddit.Auth.html#codeGrantClientSecret"><span class="hs-identifier hs-var hs-var">codeGrantClientSecret</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-102"></span><span>        </span><span id="codeGrantRedirectUri"><span class="annot"><span class="annottext">Credentials -&gt; Text
</span><a href="Reddit.Auth.html#codeGrantRedirectUri"><span class="hs-identifier hs-var hs-var">codeGrantRedirectUri</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-103"></span><span>        </span><span id="codeGrantCode"><span class="annot"><span class="annottext">Credentials -&gt; Text
</span><a href="Reddit.Auth.html#codeGrantCode"><span class="hs-identifier hs-var hs-var">codeGrantCode</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-104"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Do not provide credentials. This is used when \'reconstructing\' a</span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-comment">-- 'Reddit.RedditEnv' from an existing token (e.g. one stored in a database)</span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-comment">-- using 'Reddit.mkEnvFromToken'. __You should not need to use this.__</span><span>
</span><span id="line-108"></span><span>    </span><span id="NoCredentials"><span class="annot"><a href="Reddit.Auth.html#NoCredentials"><span class="hs-identifier hs-var">NoCredentials</span></a></span></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="hs-comment">-- * OAuth2 scopes</span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-comment">-- | Scopes are used to limit the things which a token can do. You should ensure</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- that you only request a token for the scopes that you need. When</span><span>
</span><span id="line-114"></span><span class="hs-comment">-- authenticating with Reddit, the user will be able to see which scopes are</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- being requested.</span><span>
</span><span id="line-116"></span><span class="hs-comment">--</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- To see which scope(s) are required by each endpoint, see</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- &lt;https://www.reddit.com/dev/api/oauth&gt;. Note that this library implements</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- only a small subset of endpoints, so most of these are not very useful right</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- now.</span><span>
</span><span id="line-121"></span><span class="hs-comment">--</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- You can obtain this list of scopes via &lt;https://reddit.com/api/v1/scopes&gt;.</span><span>
</span><span id="line-123"></span><span class="hs-keyword">data</span><span> </span><span id="Scope"><span class="annot"><a href="Reddit.Auth.html#Scope"><span class="hs-identifier hs-var">Scope</span></a></span></span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | Spend the logged in user's Reddit gold.</span><span>
</span><span id="line-125"></span><span>    </span><span id="ScopeCreddits"><span class="annot"><a href="Reddit.Auth.html#ScopeCreddits"><span class="hs-identifier hs-var">ScopeCreddits</span></a></span></span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Access mod notes for subreddits moderated by the logged in user.</span><span>
</span><span id="line-127"></span><span>    </span><span id="ScopeModNote"><span class="annot"><a href="Reddit.Auth.html#ScopeModNote"><span class="hs-identifier hs-var">ScopeModNote</span></a></span></span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Add\/remove users to\/from approved user lists, ban\/unban, and mute\/unmute users on subreddits moderated by the logged in user.</span><span>
</span><span id="line-129"></span><span>    </span><span id="ScopeModContributors"><span class="annot"><a href="Reddit.Auth.html#ScopeModContributors"><span class="hs-identifier hs-var">ScopeModContributors</span></a></span></span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Access and manage modmail for subreddits moderated by the logged in user.</span><span>
</span><span id="line-131"></span><span>    </span><span id="ScopeModMail"><span class="annot"><a href="Reddit.Auth.html#ScopeModMail"><span class="hs-identifier hs-var">ScopeModMail</span></a></span></span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Manage the configuration, sidebar, and CSS for subreddits moderated by the logged in user.</span><span>
</span><span id="line-133"></span><span>    </span><span id="ScopeModConfig"><span class="annot"><a href="Reddit.Auth.html#ScopeModConfig"><span class="hs-identifier hs-var">ScopeModConfig</span></a></span></span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Manage subreddit subscriptions as well as \'friends\'.</span><span>
</span><span id="line-135"></span><span>    </span><span id="ScopeSubscribe"><span class="annot"><a href="Reddit.Auth.html#ScopeSubscribe"><span class="hs-identifier hs-var">ScopeSubscribe</span></a></span></span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Edit structured styles for subreddits moderated by the logged in user.</span><span>
</span><span id="line-137"></span><span>    </span><span id="ScopeStructuredStyles"><span class="annot"><a href="Reddit.Auth.html#ScopeStructuredStyles"><span class="hs-identifier hs-var">ScopeStructuredStyles</span></a></span></span><span>
</span><span id="line-138"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Vote on posts and comments.</span><span>
</span><span id="line-139"></span><span>    </span><span id="ScopeVote"><span class="annot"><a href="Reddit.Auth.html#ScopeVote"><span class="hs-identifier hs-var">ScopeVote</span></a></span></span><span>
</span><span id="line-140"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Edit wiki pages.</span><span>
</span><span id="line-141"></span><span>    </span><span id="ScopeWikiEdit"><span class="annot"><a href="Reddit.Auth.html#ScopeWikiEdit"><span class="hs-identifier hs-var">ScopeWikiEdit</span></a></span></span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Access the list of subreddits moderated, contributed to, and subscribed to.</span><span>
</span><span id="line-143"></span><span>    </span><span id="ScopeMySubreddits"><span class="annot"><a href="Reddit.Auth.html#ScopeMySubreddits"><span class="hs-identifier hs-var">ScopeMySubreddits</span></a></span></span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Submit links and comments.</span><span>
</span><span id="line-145"></span><span>    </span><span id="ScopeSubmit"><span class="annot"><a href="Reddit.Auth.html#ScopeSubmit"><span class="hs-identifier hs-var">ScopeSubmit</span></a></span></span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Access the moderation log in subreddits moderated by the logged in user.</span><span>
</span><span id="line-147"></span><span>    </span><span id="ScopeModLog"><span class="annot"><a href="Reddit.Auth.html#ScopeModLog"><span class="hs-identifier hs-var">ScopeModLog</span></a></span></span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Approve, remove, mark as (N)SFW, and distinguish content in subreddits moderated by the logged in user.</span><span>
</span><span id="line-149"></span><span>    </span><span id="ScopeModPosts"><span class="annot"><a href="Reddit.Auth.html#ScopeModPosts"><span class="hs-identifier hs-var">ScopeModPosts</span></a></span></span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Manage and assign flair in subreddits moderated by the logged in user.</span><span>
</span><span id="line-151"></span><span>    </span><span id="ScopeModFlair"><span class="annot"><a href="Reddit.Auth.html#ScopeModFlair"><span class="hs-identifier hs-var">ScopeModFlair</span></a></span></span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Save and unsave posts and comments.</span><span>
</span><span id="line-153"></span><span>    </span><span id="ScopeSave"><span class="annot"><a href="Reddit.Auth.html#ScopeSave"><span class="hs-identifier hs-var">ScopeSave</span></a></span></span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Invite and remove moderators on subreddits moderated by the logged in user.</span><span>
</span><span id="line-155"></span><span>    </span><span id="ScopeModOthers"><span class="annot"><a href="Reddit.Auth.html#ScopeModOthers"><span class="hs-identifier hs-var">ScopeModOthers</span></a></span></span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Access posts and comments.</span><span>
</span><span id="line-157"></span><span>    </span><span id="ScopeRead"><span class="annot"><a href="Reddit.Auth.html#ScopeRead"><span class="hs-identifier hs-var">ScopeRead</span></a></span></span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Read and send private messages. (Note: this does not include chat. There is, at present, no way to access chat via the public Reddit API.)</span><span>
</span><span id="line-159"></span><span>    </span><span id="ScopePrivateMessages"><span class="annot"><a href="Reddit.Auth.html#ScopePrivateMessages"><span class="hs-identifier hs-var">ScopePrivateMessages</span></a></span></span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Report, hide, and unhide content.</span><span>
</span><span id="line-161"></span><span>    </span><span id="ScopeReport"><span class="annot"><a href="Reddit.Auth.html#ScopeReport"><span class="hs-identifier hs-var">ScopeReport</span></a></span></span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Get Reddit username and signup date.</span><span>
</span><span id="line-163"></span><span>    </span><span id="ScopeIdentity"><span class="annot"><a href="Reddit.Auth.html#ScopeIdentity"><span class="hs-identifier hs-var">ScopeIdentity</span></a></span></span><span>
</span><span id="line-164"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Manage settings and contributors of live threads.</span><span>
</span><span id="line-165"></span><span>    </span><span id="ScopeLiveManage"><span class="annot"><a href="Reddit.Auth.html#ScopeLiveManage"><span class="hs-identifier hs-var">ScopeLiveManage</span></a></span></span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Update preferences and other account information. Does not grant access to email or password.</span><span>
</span><span id="line-167"></span><span>    </span><span id="ScopeAccount"><span class="annot"><a href="Reddit.Auth.html#ScopeAccount"><span class="hs-identifier hs-var">ScopeAccount</span></a></span></span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Access traffic stats in subreddits moderated by the user.</span><span>
</span><span id="line-169"></span><span>    </span><span id="ScopeModTraffic"><span class="annot"><a href="Reddit.Auth.html#ScopeModTraffic"><span class="hs-identifier hs-var">ScopeModTraffic</span></a></span></span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Read wiki pages.</span><span>
</span><span id="line-171"></span><span>    </span><span id="ScopeWikiRead"><span class="annot"><a href="Reddit.Auth.html#ScopeWikiRead"><span class="hs-identifier hs-var">ScopeWikiRead</span></a></span></span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Edit and delete posts and comments.</span><span>
</span><span id="line-173"></span><span>    </span><span id="ScopeEdit"><span class="annot"><a href="Reddit.Auth.html#ScopeEdit"><span class="hs-identifier hs-var">ScopeEdit</span></a></span></span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Change editors and visibility of wiki pages in subreddits moderated by the logged in user.</span><span>
</span><span id="line-175"></span><span>    </span><span id="ScopeModWiki"><span class="annot"><a href="Reddit.Auth.html#ScopeModWiki"><span class="hs-identifier hs-var">ScopeModWiki</span></a></span></span><span>
</span><span id="line-176"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Accept invitations to moderate a subreddit and step down from moderating subreddits.</span><span>
</span><span id="line-177"></span><span>    </span><span id="ScopeModSelf"><span class="annot"><a href="Reddit.Auth.html#ScopeModSelf"><span class="hs-identifier hs-var">ScopeModSelf</span></a></span></span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Access voting history, saved submissions, and hidden submissions.</span><span>
</span><span id="line-179"></span><span>    </span><span id="ScopeHistory"><span class="annot"><a href="Reddit.Auth.html#ScopeHistory"><span class="hs-identifier hs-var">ScopeHistory</span></a></span></span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Edit subreddit and post flair.</span><span>
</span><span id="line-181"></span><span>    </span><span id="ScopeFlair"><span class="annot"><a href="Reddit.Auth.html#ScopeFlair"><span class="hs-identifier hs-var">ScopeFlair</span></a></span></span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679102897"><span id="local-6989586621679102899"><span class="annot"><span class="annottext">Scope -&gt; Scope -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Scope -&gt; Scope -&gt; Bool
$c/= :: Scope -&gt; Scope -&gt; Bool
== :: Scope -&gt; Scope -&gt; Bool
$c== :: Scope -&gt; Scope -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679102877"><span id="local-6989586621679102879"><span id="local-6989586621679102882"><span id="local-6989586621679102885"><span id="local-6989586621679102888"><span id="local-6989586621679102890"><span id="local-6989586621679102892"><span class="annot"><span class="annottext">Eq Scope
Scope -&gt; Scope -&gt; Bool
Scope -&gt; Scope -&gt; Ordering
Scope -&gt; Scope -&gt; Scope
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: Scope -&gt; Scope -&gt; Scope
$cmin :: Scope -&gt; Scope -&gt; Scope
max :: Scope -&gt; Scope -&gt; Scope
$cmax :: Scope -&gt; Scope -&gt; Scope
&gt;= :: Scope -&gt; Scope -&gt; Bool
$c&gt;= :: Scope -&gt; Scope -&gt; Bool
&gt; :: Scope -&gt; Scope -&gt; Bool
$c&gt; :: Scope -&gt; Scope -&gt; Bool
&lt;= :: Scope -&gt; Scope -&gt; Bool
$c&lt;= :: Scope -&gt; Scope -&gt; Bool
&lt; :: Scope -&gt; Scope -&gt; Bool
$c&lt; :: Scope -&gt; Scope -&gt; Bool
compare :: Scope -&gt; Scope -&gt; Ordering
$ccompare :: Scope -&gt; Scope -&gt; Ordering
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679102834"><span id="local-6989586621679102836"><span id="local-6989586621679102840"><span id="local-6989586621679102844"><span id="local-6989586621679102846"><span id="local-6989586621679102860"><span id="local-6989586621679102866"><span id="local-6989586621679102874"><span class="annot"><span class="annottext">Int -&gt; Scope
Scope -&gt; Int
Scope -&gt; [Scope]
Scope -&gt; Scope
Scope -&gt; Scope -&gt; [Scope]
Scope -&gt; Scope -&gt; Scope -&gt; [Scope]
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
enumFromThenTo :: Scope -&gt; Scope -&gt; Scope -&gt; [Scope]
$cenumFromThenTo :: Scope -&gt; Scope -&gt; Scope -&gt; [Scope]
enumFromTo :: Scope -&gt; Scope -&gt; [Scope]
$cenumFromTo :: Scope -&gt; Scope -&gt; [Scope]
enumFromThen :: Scope -&gt; Scope -&gt; [Scope]
$cenumFromThen :: Scope -&gt; Scope -&gt; [Scope]
enumFrom :: Scope -&gt; [Scope]
$cenumFrom :: Scope -&gt; [Scope]
fromEnum :: Scope -&gt; Int
$cfromEnum :: Scope -&gt; Int
toEnum :: Int -&gt; Scope
$ctoEnum :: Int -&gt; Scope
pred :: Scope -&gt; Scope
$cpred :: Scope -&gt; Scope
succ :: Scope -&gt; Scope
$csucc :: Scope -&gt; Scope
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></a></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679102829"><span id="local-6989586621679102831"><span class="annot"><span class="annottext">Scope
forall a. a -&gt; a -&gt; Bounded a
maxBound :: Scope
$cmaxBound :: Scope
minBound :: Scope
$cminBound :: Scope
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Bounded</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679102822"><span id="local-6989586621679102824"><span id="local-6989586621679102826"><span class="annot"><span class="annottext">Int -&gt; Scope -&gt; ShowS
[Scope] -&gt; ShowS
Scope -&gt; [Char]
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Scope] -&gt; ShowS
$cshowList :: [Scope] -&gt; ShowS
show :: Scope -&gt; [Char]
$cshow :: Scope -&gt; [Char]
showsPrec :: Int -&gt; Scope -&gt; ShowS
$cshowsPrec :: Int -&gt; Scope -&gt; ShowS
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="hs-comment">-- | A quick way to get all scopes.</span><span>
</span><span id="line-185"></span><span class="annot"><a href="Reddit.Auth.html#allScopes"><span class="hs-identifier hs-type">allScopes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">S.Set</span></a></span><span> </span><span class="annot"><a href="Reddit.Auth.html#Scope"><span class="hs-identifier hs-type">Scope</span></a></span><span>
</span><span id="line-186"></span><span id="allScopes"><span class="annot"><span class="annottext">allScopes :: Set Scope
</span><a href="Reddit.Auth.html#allScopes"><span class="hs-identifier hs-var hs-var">allScopes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.fromList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall a. Bounded a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">minBound</span></a></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">forall a. Bounded a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maxBound</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span class="hs-comment">-- | Parse a canonical text list of scopes, which is part of the JSON returned</span><span>
</span><span id="line-189"></span><span class="hs-comment">-- by the Reddit authorisation server, into a set of known @Scope@s.</span><span>
</span><span id="line-190"></span><span class="annot"><a href="Reddit.Auth.html#parseScopes"><span class="hs-identifier hs-type">parseScopes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">S.Set</span></a></span><span> </span><span class="annot"><a href="Reddit.Auth.html#Scope"><span class="hs-identifier hs-type">Scope</span></a></span><span>
</span><span id="line-191"></span><span id="parseScopes"><span class="annot"><span class="annottext">parseScopes :: Text -&gt; Set Scope
</span><a href="Reddit.Auth.html#parseScopes"><span class="hs-identifier hs-var hs-var">parseScopes</span></a></span></span><span> </span><span id="local-6989586621679102817"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679102817"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Text -&gt; [Text]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-var">T.split</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679102815"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679102815"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679102815"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">','</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679102815"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679102817"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.empty</span></a></span><span>
</span><span id="line-193"></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621679102812"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679102812"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679102812"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-194"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.empty</span></a></span><span>
</span><span id="line-195"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.fromList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall a. Bounded a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">minBound</span></a></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">forall a. Bounded a =&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maxBound</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- All scopes</span><span>
</span><span id="line-196"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;account&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeAccount"><span class="hs-identifier hs-var">ScopeAccount</span></a></span><span>
</span><span id="line-197"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;creddits&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeCreddits"><span class="hs-identifier hs-var">ScopeCreddits</span></a></span><span>
</span><span id="line-198"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;edit&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeEdit"><span class="hs-identifier hs-var">ScopeEdit</span></a></span><span>
</span><span id="line-199"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;flair&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeFlair"><span class="hs-identifier hs-var">ScopeFlair</span></a></span><span>
</span><span id="line-200"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;history&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeHistory"><span class="hs-identifier hs-var">ScopeHistory</span></a></span><span>
</span><span id="line-201"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;identity&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeIdentity"><span class="hs-identifier hs-var">ScopeIdentity</span></a></span><span>
</span><span id="line-202"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;livemanage&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeLiveManage"><span class="hs-identifier hs-var">ScopeLiveManage</span></a></span><span>
</span><span id="line-203"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;modconfig&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModConfig"><span class="hs-identifier hs-var">ScopeModConfig</span></a></span><span>
</span><span id="line-204"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;modcontributors&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModContributors"><span class="hs-identifier hs-var">ScopeModContributors</span></a></span><span>
</span><span id="line-205"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;modflair&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModFlair"><span class="hs-identifier hs-var">ScopeModFlair</span></a></span><span>
</span><span id="line-206"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;modlog&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModLog"><span class="hs-identifier hs-var">ScopeModLog</span></a></span><span>
</span><span id="line-207"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;modmail&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModMail"><span class="hs-identifier hs-var">ScopeModMail</span></a></span><span>
</span><span id="line-208"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;modnote&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModNote"><span class="hs-identifier hs-var">ScopeModNote</span></a></span><span>
</span><span id="line-209"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;modothers&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModOthers"><span class="hs-identifier hs-var">ScopeModOthers</span></a></span><span>
</span><span id="line-210"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;modposts&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModPosts"><span class="hs-identifier hs-var">ScopeModPosts</span></a></span><span>
</span><span id="line-211"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;modself&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModSelf"><span class="hs-identifier hs-var">ScopeModSelf</span></a></span><span>
</span><span id="line-212"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;modtraffic&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModTraffic"><span class="hs-identifier hs-var">ScopeModTraffic</span></a></span><span>
</span><span id="line-213"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;modwiki&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModWiki"><span class="hs-identifier hs-var">ScopeModWiki</span></a></span><span>
</span><span id="line-214"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;mysubreddits&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeMySubreddits"><span class="hs-identifier hs-var">ScopeMySubreddits</span></a></span><span>
</span><span id="line-215"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;privatemessages&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopePrivateMessages"><span class="hs-identifier hs-var">ScopePrivateMessages</span></a></span><span>
</span><span id="line-216"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;read&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeRead"><span class="hs-identifier hs-var">ScopeRead</span></a></span><span>
</span><span id="line-217"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;report&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeReport"><span class="hs-identifier hs-var">ScopeReport</span></a></span><span>
</span><span id="line-218"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;save&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeSave"><span class="hs-identifier hs-var">ScopeSave</span></a></span><span>
</span><span id="line-219"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;structuredstyles&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeStructuredStyles"><span class="hs-identifier hs-var">ScopeStructuredStyles</span></a></span><span>
</span><span id="line-220"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;submit&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeSubmit"><span class="hs-identifier hs-var">ScopeSubmit</span></a></span><span>
</span><span id="line-221"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;subscribe&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeSubscribe"><span class="hs-identifier hs-var">ScopeSubscribe</span></a></span><span>
</span><span id="line-222"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;vote&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeVote"><span class="hs-identifier hs-var">ScopeVote</span></a></span><span>
</span><span id="line-223"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;wikiedit&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeWikiEdit"><span class="hs-identifier hs-var">ScopeWikiEdit</span></a></span><span>
</span><span id="line-224"></span><span>    </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;wikiread&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Set a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeWikiRead"><span class="hs-identifier hs-var">ScopeWikiRead</span></a></span><span>
</span><span id="line-225"></span><span>  </span><span id="local-6989586621679102810"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679102810"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mconcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Set Scope
</span><a href="Reddit.Auth.html#parseScopes"><span class="hs-identifier hs-var">parseScopes</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679102810"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span class="hs-comment">-- | Construct a canonical text representation of a set of @Scope@s, which can</span><span>
</span><span id="line-228"></span><span class="hs-comment">-- be used as a query parameter for 'mkRedditAuthURL'.</span><span>
</span><span id="line-229"></span><span class="annot"><a href="Reddit.Auth.html#showScopes"><span class="hs-identifier hs-type">showScopes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">S.Set</span></a></span><span> </span><span class="annot"><a href="Reddit.Auth.html#Scope"><span class="hs-identifier hs-type">Scope</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-230"></span><span id="showScopes"><span class="annot"><span class="annottext">showScopes :: Set Scope -&gt; Text
</span><a href="Reddit.Auth.html#showScopes"><span class="hs-identifier hs-var hs-var">showScopes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; Text
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-var">T.intercalate</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall {a}. IsString a =&gt; Scope -&gt; a
</span><a href="#local-6989586621679102807"><span class="hs-identifier hs-var">showOneScope</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Set a -&gt; [a]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-var">S.toList</span></a></span><span>
</span><span id="line-231"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-232"></span><span>    </span><span id="local-6989586621679102807"><span class="annot"><span class="annottext">showOneScope :: Scope -&gt; a
</span><a href="#local-6989586621679102807"><span class="hs-identifier hs-var hs-var">showOneScope</span></a></span></span><span> </span><span id="local-6989586621679102775"><span class="annot"><span class="annottext">Scope
</span><a href="#local-6989586621679102775"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Scope
</span><a href="#local-6989586621679102775"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-233"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeAccount"><span class="hs-identifier hs-var">ScopeAccount</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;account&quot;</span></span><span>
</span><span id="line-234"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeCreddits"><span class="hs-identifier hs-var">ScopeCreddits</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;creddits&quot;</span></span><span>
</span><span id="line-235"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeEdit"><span class="hs-identifier hs-var">ScopeEdit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;edit&quot;</span></span><span>
</span><span id="line-236"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeFlair"><span class="hs-identifier hs-var">ScopeFlair</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;flair&quot;</span></span><span>
</span><span id="line-237"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeHistory"><span class="hs-identifier hs-var">ScopeHistory</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;history&quot;</span></span><span>
</span><span id="line-238"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeIdentity"><span class="hs-identifier hs-var">ScopeIdentity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;identity&quot;</span></span><span>
</span><span id="line-239"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeLiveManage"><span class="hs-identifier hs-var">ScopeLiveManage</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;livemanage&quot;</span></span><span>
</span><span id="line-240"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModConfig"><span class="hs-identifier hs-var">ScopeModConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;modconfig&quot;</span></span><span>
</span><span id="line-241"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModContributors"><span class="hs-identifier hs-var">ScopeModContributors</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;modcontributors&quot;</span></span><span>
</span><span id="line-242"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModFlair"><span class="hs-identifier hs-var">ScopeModFlair</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;modflair&quot;</span></span><span>
</span><span id="line-243"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModLog"><span class="hs-identifier hs-var">ScopeModLog</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;modlog&quot;</span></span><span>
</span><span id="line-244"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModMail"><span class="hs-identifier hs-var">ScopeModMail</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;modmail&quot;</span></span><span>
</span><span id="line-245"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModNote"><span class="hs-identifier hs-var">ScopeModNote</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;modnote&quot;</span></span><span>
</span><span id="line-246"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModOthers"><span class="hs-identifier hs-var">ScopeModOthers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;modothers&quot;</span></span><span>
</span><span id="line-247"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModPosts"><span class="hs-identifier hs-var">ScopeModPosts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;modposts&quot;</span></span><span>
</span><span id="line-248"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModSelf"><span class="hs-identifier hs-var">ScopeModSelf</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;modself&quot;</span></span><span>
</span><span id="line-249"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModTraffic"><span class="hs-identifier hs-var">ScopeModTraffic</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;modtraffic&quot;</span></span><span>
</span><span id="line-250"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeModWiki"><span class="hs-identifier hs-var">ScopeModWiki</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;modwiki&quot;</span></span><span>
</span><span id="line-251"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeMySubreddits"><span class="hs-identifier hs-var">ScopeMySubreddits</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;mysubreddits&quot;</span></span><span>
</span><span id="line-252"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopePrivateMessages"><span class="hs-identifier hs-var">ScopePrivateMessages</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;privatemessages&quot;</span></span><span>
</span><span id="line-253"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeRead"><span class="hs-identifier hs-var">ScopeRead</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;read&quot;</span></span><span>
</span><span id="line-254"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeReport"><span class="hs-identifier hs-var">ScopeReport</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;report&quot;</span></span><span>
</span><span id="line-255"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeSave"><span class="hs-identifier hs-var">ScopeSave</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;save&quot;</span></span><span>
</span><span id="line-256"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeStructuredStyles"><span class="hs-identifier hs-var">ScopeStructuredStyles</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;structuredstyles&quot;</span></span><span>
</span><span id="line-257"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeSubmit"><span class="hs-identifier hs-var">ScopeSubmit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;submit&quot;</span></span><span>
</span><span id="line-258"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeSubscribe"><span class="hs-identifier hs-var">ScopeSubscribe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;subscribe&quot;</span></span><span>
</span><span id="line-259"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeVote"><span class="hs-identifier hs-var">ScopeVote</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;vote&quot;</span></span><span>
</span><span id="line-260"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeWikiEdit"><span class="hs-identifier hs-var">ScopeWikiEdit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;wikiedit&quot;</span></span><span>
</span><span id="line-261"></span><span>      </span><span class="annot"><span class="annottext">Scope
</span><a href="Reddit.Auth.html#ScopeWikiRead"><span class="hs-identifier hs-var">ScopeWikiRead</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;wikiread&quot;</span></span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span class="hs-comment">-- * Access tokens</span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span class="hs-comment">-- | The raw JSON representation of an access token, as returned by Reddit.</span><span>
</span><span id="line-266"></span><span class="hs-keyword">data</span><span> </span><span id="TokenInternal"><span class="annot"><a href="Reddit.Auth.html#TokenInternal"><span class="hs-identifier hs-var">TokenInternal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TokenInternal"><span class="annot"><a href="Reddit.Auth.html#TokenInternal"><span class="hs-identifier hs-var">TokenInternal</span></a></span></span><span>
</span><span id="line-267"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="tknintToken"><span class="annot"><span class="annottext">TokenInternal -&gt; Text
</span><a href="Reddit.Auth.html#tknintToken"><span class="hs-identifier hs-var hs-var">tknintToken</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-268"></span><span>    </span><span id="tknintType"><span class="annot"><span class="annottext">TokenInternal -&gt; Text
</span><a href="Reddit.Auth.html#tknintType"><span class="hs-identifier hs-var hs-var">tknintType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-269"></span><span>    </span><span id="tknintExpiresIn"><span class="annot"><span class="annottext">TokenInternal -&gt; Int
</span><a href="Reddit.Auth.html#tknintExpiresIn"><span class="hs-identifier hs-var hs-var">tknintExpiresIn</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-270"></span><span>    </span><span id="tknintScopes"><span class="annot"><span class="annottext">TokenInternal -&gt; Text
</span><a href="Reddit.Auth.html#tknintScopes"><span class="hs-identifier hs-var hs-var">tknintScopes</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-271"></span><span>    </span><span id="tknintRefreshToken"><span class="annot"><span class="annottext">TokenInternal -&gt; Maybe Text
</span><a href="Reddit.Auth.html#tknintRefreshToken"><span class="hs-identifier hs-var hs-var">tknintRefreshToken</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679102764"><span id="local-6989586621679102766"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Reddit.Auth.html#TokenInternal"><span class="hs-identifier hs-type">TokenInternal</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-275"></span><span>  </span><span id="local-6989586621679102741"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser TokenInternal
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [Char] -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">withObject</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;TokenInternal&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679102738"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679102738"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-276"></span><span>    </span><span id="local-6989586621679102737"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679102737"><span class="hs-identifier hs-var">tknintToken</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679102738"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;access_token&quot;</span></span><span>
</span><span id="line-277"></span><span>    </span><span id="local-6989586621679102735"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679102735"><span class="hs-identifier hs-var">tknintType</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679102738"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;token_type&quot;</span></span><span>
</span><span id="line-278"></span><span>    </span><span id="local-6989586621679102734"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679102734"><span class="hs-identifier hs-var">tknintExpiresIn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679102738"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;expires_in&quot;</span></span><span>
</span><span id="line-279"></span><span>    </span><span id="local-6989586621679102733"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679102733"><span class="hs-identifier hs-var">tknintScopes</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679102738"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;scope&quot;</span></span><span>
</span><span id="line-280"></span><span>    </span><span id="local-6989586621679102732"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621679102732"><span class="hs-identifier hs-var">tknintRefreshToken</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679102738"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser (Maybe a)
</span><span class="hs-operator hs-var">.:?</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;refresh_token&quot;</span></span><span>
</span><span id="line-281"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><a href="Reddit.Auth.html#TokenInternal"><span class="hs-identifier hs-type">TokenInternal</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">Int
Maybe Text
Text
tknintRefreshToken :: Maybe Text
tknintScopes :: Text
tknintExpiresIn :: Int
tknintType :: Text
tknintToken :: Text
tknintRefreshToken :: Maybe Text
tknintScopes :: Text
tknintExpiresIn :: Int
tknintType :: Text
tknintToken :: Text
</span><a href="#local-6989586621679102732"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="hs-comment">-- | Obtain a raw token using credentials.</span><span>
</span><span id="line-284"></span><span class="annot"><a href="Reddit.Auth.html#getTokenInternal"><span class="hs-identifier hs-type">getTokenInternal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reddit.Auth.html#Credentials"><span class="hs-identifier hs-type">Credentials</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/bytestring-0.11.4.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Reddit.Auth.html#TokenInternal"><span class="hs-identifier hs-type">TokenInternal</span></a></span><span>
</span><span id="line-285"></span><span id="getTokenInternal"><span class="annot"><span class="annottext">getTokenInternal :: Credentials -&gt; ByteString -&gt; IO TokenInternal
</span><a href="Reddit.Auth.html#getTokenInternal"><span class="hs-identifier hs-var hs-var">getTokenInternal</span></a></span></span><span> </span><span id="local-6989586621679102729"><span class="annot"><span class="annottext">Credentials
</span><a href="#local-6989586621679102729"><span class="hs-identifier hs-var">creds</span></a></span></span><span> </span><span id="local-6989586621679102728"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679102728"><span class="hs-identifier hs-var">ua</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-286"></span><span>  </span><span class="hs-comment">-- Note that {..} RecordWildCards lets us use the field names as the values</span><span>
</span><span id="line-287"></span><span>  </span><span class="hs-comment">-- themselves, instead of as accessor functions</span><span>
</span><span id="line-288"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Credentials
</span><a href="#local-6989586621679102729"><span class="hs-identifier hs-var">creds</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-289"></span><span>    </span><span class="annot"><a href="Reddit.Auth.html#OwnerCredentials"><span class="hs-identifier hs-type">OwnerCredentials</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679102724"><span id="local-6989586621679102725"><span id="local-6989586621679102726"><span id="local-6989586621679102727"><span class="annot"><span class="annottext">Text
ownerClientSecret :: Text
ownerClientId :: Text
ownerPassword :: Text
ownerUsername :: Text
ownerClientSecret :: Credentials -&gt; Text
ownerClientId :: Credentials -&gt; Text
ownerPassword :: Credentials -&gt; Text
ownerUsername :: Credentials -&gt; Text
</span><a href="#local-6989586621679102724"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; HttpConfig -&gt; Req a -&gt; m a
</span><span class="hs-identifier hs-var">runReq</span></span><span> </span><span class="annot"><span class="annottext">HttpConfig
</span><span class="hs-identifier hs-var">defaultHttpConfig</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-290"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679102717"><span class="annot"><span class="annottext">uri :: Url 'Https
</span><a href="#local-6989586621679102717"><span class="hs-identifier hs-var hs-var">uri</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Url 'Https
</span><span class="hs-identifier hs-var">https</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;www.reddit.com&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (scheme :: Scheme). Url scheme -&gt; Text -&gt; Url scheme
</span><span class="hs-operator hs-var">/:</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;api&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (scheme :: Scheme). Url scheme -&gt; Text -&gt; Url scheme
</span><span class="hs-operator hs-var">/:</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;v1&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (scheme :: Scheme). Url scheme -&gt; Text -&gt; Url scheme
</span><span class="hs-operator hs-var">/:</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;access_token&quot;</span></span><span>
</span><span id="line-291"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679102714"><span class="annot"><span class="annottext">body :: ReqBodyUrlEnc
</span><a href="#local-6989586621679102714"><span class="hs-identifier hs-var hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-292"></span><span>            </span><span class="annot"><span class="annottext">FormUrlEncodedParam -&gt; ReqBodyUrlEnc
</span><span class="hs-identifier hs-var">ReqBodyUrlEnc</span></span><span>
</span><span id="line-293"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;grant_type&quot;</span></span><span>
</span><span id="line-294"></span><span>                  </span><span class="annot"><span class="annottext">forall param a.
(QueryParam param, ToHttpApiData a) =&gt;
Text -&gt; a -&gt; param
</span><span class="hs-operator hs-var">=:</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;password&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span>                  </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;username&quot;</span></span><span>
</span><span id="line-296"></span><span>                    </span><span class="annot"><span class="annottext">forall param a.
(QueryParam param, ToHttpApiData a) =&gt;
Text -&gt; a -&gt; param
</span><span class="hs-operator hs-var">=:</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679102727"><span class="hs-identifier hs-var">ownerUsername</span></a></span><span>
</span><span id="line-297"></span><span>                  </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;password&quot;</span></span><span>
</span><span id="line-298"></span><span>                    </span><span class="annot"><span class="annottext">forall param a.
(QueryParam param, ToHttpApiData a) =&gt;
Text -&gt; a -&gt; param
</span><span class="hs-operator hs-var">=:</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679102726"><span class="hs-identifier hs-var">ownerPassword</span></a></span><span>
</span><span id="line-299"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-300"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679102711"><span class="annot"><span class="annottext">req_params :: Option 'Https
</span><a href="#local-6989586621679102711"><span class="hs-identifier hs-var hs-var">req_params</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-301"></span><span>            </span><span class="annot"><span class="annottext">forall (scheme :: Scheme).
ByteString -&gt; ByteString -&gt; Option scheme
</span><span class="hs-identifier hs-var">header</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;user-agent&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679102728"><span class="hs-identifier hs-var">ua</span></a></span><span>
</span><span id="line-302"></span><span>              </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Option 'Https
</span><span class="hs-identifier hs-var">basicAuth</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-var">TE.encodeUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679102725"><span class="hs-identifier hs-var">ownerClientId</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-var">TE.encodeUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679102724"><span class="hs-identifier hs-var">ownerClientSecret</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span>      </span><span id="local-6989586621679102707"><span class="annot"><span class="annottext">LbsResponse
</span><a href="#local-6989586621679102707"><span class="hs-identifier hs-var">response</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) method body response (scheme :: Scheme).
(MonadHttp m, HttpMethod method, HttpBody body,
 HttpResponse response,
 HttpBodyAllowed (AllowsBody method) (ProvidesBody body)) =&gt;
method
-&gt; Url scheme
-&gt; body
-&gt; Proxy response
-&gt; Option scheme
-&gt; m response
</span><span class="hs-identifier hs-var">req</span></span><span> </span><span class="annot"><span class="annottext">POST
</span><span class="hs-identifier hs-var">POST</span></span><span> </span><span class="annot"><span class="annottext">Url 'Https
</span><a href="#local-6989586621679102717"><span class="hs-identifier hs-var">uri</span></a></span><span> </span><span class="annot"><span class="annottext">ReqBodyUrlEnc
</span><a href="#local-6989586621679102714"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy LbsResponse
</span><span class="hs-identifier hs-var">lbsResponse</span></span><span> </span><span class="annot"><span class="annottext">Option 'Https
</span><a href="#local-6989586621679102711"><span class="hs-identifier hs-var">req_params</span></a></span><span>
</span><span id="line-304"></span><span>      </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *).
(FromJSON a, MonadThrow m) =&gt;
ByteString -&gt; m a
</span><span class="hs-identifier hs-var">throwDecode</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall response.
HttpResponse response =&gt;
response -&gt; HttpResponseBody response
</span><span class="hs-identifier hs-var">responseBody</span></span><span> </span><span class="annot"><span class="annottext">LbsResponse
</span><a href="#local-6989586621679102707"><span class="hs-identifier hs-var">response</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>    </span><span class="annot"><a href="Reddit.Auth.html#CodeGrantCredentials"><span class="hs-identifier hs-type">CodeGrantCredentials</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679102698"><span id="local-6989586621679102699"><span id="local-6989586621679102700"><span id="local-6989586621679102701"><span class="annot"><span class="annottext">Text
codeGrantCode :: Text
codeGrantRedirectUri :: Text
codeGrantClientSecret :: Text
codeGrantClientId :: Text
codeGrantCode :: Credentials -&gt; Text
codeGrantRedirectUri :: Credentials -&gt; Text
codeGrantClientSecret :: Credentials -&gt; Text
codeGrantClientId :: Credentials -&gt; Text
</span><a href="#local-6989586621679102698"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; HttpConfig -&gt; Req a -&gt; m a
</span><span class="hs-identifier hs-var">runReq</span></span><span> </span><span class="annot"><span class="annottext">HttpConfig
</span><span class="hs-identifier hs-var">defaultHttpConfig</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-306"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679102693"><span class="annot"><span class="annottext">uri :: Url 'Https
</span><a href="#local-6989586621679102693"><span class="hs-identifier hs-var hs-var">uri</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Url 'Https
</span><span class="hs-identifier hs-var">https</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;www.reddit.com&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (scheme :: Scheme). Url scheme -&gt; Text -&gt; Url scheme
</span><span class="hs-operator hs-var">/:</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;api&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (scheme :: Scheme). Url scheme -&gt; Text -&gt; Url scheme
</span><span class="hs-operator hs-var">/:</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;v1&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall (scheme :: Scheme). Url scheme -&gt; Text -&gt; Url scheme
</span><span class="hs-operator hs-var">/:</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;access_token&quot;</span></span><span>
</span><span id="line-307"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679102692"><span class="annot"><span class="annottext">body :: ReqBodyUrlEnc
</span><a href="#local-6989586621679102692"><span class="hs-identifier hs-var hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-308"></span><span>            </span><span class="annot"><span class="annottext">FormUrlEncodedParam -&gt; ReqBodyUrlEnc
</span><span class="hs-identifier hs-var">ReqBodyUrlEnc</span></span><span>
</span><span id="line-309"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;grant_type&quot;</span></span><span>
</span><span id="line-310"></span><span>                  </span><span class="annot"><span class="annottext">forall param a.
(QueryParam param, ToHttpApiData a) =&gt;
Text -&gt; a -&gt; param
</span><span class="hs-operator hs-var">=:</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;authorization_code&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>                  </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;redirect_uri&quot;</span></span><span>
</span><span id="line-312"></span><span>                    </span><span class="annot"><span class="annottext">forall param a.
(QueryParam param, ToHttpApiData a) =&gt;
Text -&gt; a -&gt; param
</span><span class="hs-operator hs-var">=:</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679102699"><span class="hs-identifier hs-var">codeGrantRedirectUri</span></a></span><span>
</span><span id="line-313"></span><span>                  </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;code&quot;</span></span><span>
</span><span id="line-314"></span><span>                    </span><span class="annot"><span class="annottext">forall param a.
(QueryParam param, ToHttpApiData a) =&gt;
Text -&gt; a -&gt; param
</span><span class="hs-operator hs-var">=:</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679102698"><span class="hs-identifier hs-var">codeGrantCode</span></a></span><span>
</span><span id="line-315"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679102691"><span class="annot"><span class="annottext">req_params :: Option 'Https
</span><a href="#local-6989586621679102691"><span class="hs-identifier hs-var hs-var">req_params</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-317"></span><span>            </span><span class="annot"><span class="annottext">forall (scheme :: Scheme).
ByteString -&gt; ByteString -&gt; Option scheme
</span><span class="hs-identifier hs-var">header</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;user-agent&quot;</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679102728"><span class="hs-identifier hs-var">ua</span></a></span><span>
</span><span id="line-318"></span><span>              </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Option 'Https
</span><span class="hs-identifier hs-var">basicAuth</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-var">TE.encodeUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679102701"><span class="hs-identifier hs-var">codeGrantClientId</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-var">TE.encodeUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679102700"><span class="hs-identifier hs-var">codeGrantClientSecret</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>      </span><span id="local-6989586621679102690"><span class="annot"><span class="annottext">LbsResponse
</span><a href="#local-6989586621679102690"><span class="hs-identifier hs-var">response</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) method body response (scheme :: Scheme).
(MonadHttp m, HttpMethod method, HttpBody body,
 HttpResponse response,
 HttpBodyAllowed (AllowsBody method) (ProvidesBody body)) =&gt;
method
-&gt; Url scheme
-&gt; body
-&gt; Proxy response
-&gt; Option scheme
-&gt; m response
</span><span class="hs-identifier hs-var">req</span></span><span> </span><span class="annot"><span class="annottext">POST
</span><span class="hs-identifier hs-var">POST</span></span><span> </span><span class="annot"><span class="annottext">Url 'Https
</span><a href="#local-6989586621679102693"><span class="hs-identifier hs-var">uri</span></a></span><span> </span><span class="annot"><span class="annottext">ReqBodyUrlEnc
</span><a href="#local-6989586621679102692"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy LbsResponse
</span><span class="hs-identifier hs-var">lbsResponse</span></span><span> </span><span class="annot"><span class="annottext">Option 'Https
</span><a href="#local-6989586621679102691"><span class="hs-identifier hs-var">req_params</span></a></span><span>
</span><span id="line-320"></span><span>      </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *).
(FromJSON a, MonadThrow m) =&gt;
ByteString -&gt; m a
</span><span class="hs-identifier hs-var">throwDecode</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall response.
HttpResponse response =&gt;
response -&gt; HttpResponseBody response
</span><span class="hs-identifier hs-var">responseBody</span></span><span> </span><span class="annot"><span class="annottext">LbsResponse
</span><a href="#local-6989586621679102690"><span class="hs-identifier hs-var">response</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="hs-comment">-- | A parsed value of a Reddit access token.</span><span>
</span><span id="line-323"></span><span class="hs-keyword">data</span><span> </span><span id="Token"><span class="annot"><a href="Reddit.Auth.html#Token"><span class="hs-identifier hs-var">Token</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Token"><span class="annot"><a href="Reddit.Auth.html#Token"><span class="hs-identifier hs-var">Token</span></a></span></span><span>
</span><span id="line-324"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="token"><span class="annot"><span class="annottext">Token -&gt; ByteString
</span><a href="Reddit.Auth.html#token"><span class="hs-identifier hs-var hs-var">token</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/bytestring-0.11.4.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-325"></span><span>    </span><span id="tokenType"><span class="annot"><span class="annottext">Token -&gt; ByteString
</span><a href="Reddit.Auth.html#tokenType"><span class="hs-identifier hs-var hs-var">tokenType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/bytestring-0.11.4.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-326"></span><span>    </span><span id="tokenExpiresAt"><span class="annot"><span class="annottext">Token -&gt; UTCTime
</span><a href="Reddit.Auth.html#tokenExpiresAt"><span class="hs-identifier hs-var hs-var">tokenExpiresAt</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/time-1.11.1.1/src"><span class="hs-identifier hs-type">UTCTime</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-327"></span><span>    </span><span id="tokenScopes"><span class="annot"><span class="annottext">Token -&gt; Set Scope
</span><a href="Reddit.Auth.html#tokenScopes"><span class="hs-identifier hs-var hs-var">tokenScopes</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">S.Set</span></a></span><span> </span><span class="annot"><a href="Reddit.Auth.html#Scope"><span class="hs-identifier hs-type">Scope</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-328"></span><span>    </span><span class="hs-comment">-- | Doesn't always exist</span><span>
</span><span id="line-329"></span><span>    </span><span id="tokenRefreshToken"><span class="annot"><span class="annottext">Token -&gt; Maybe Text
</span><a href="Reddit.Auth.html#tokenRefreshToken"><span class="hs-identifier hs-var hs-var">tokenRefreshToken</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-330"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span class="annot"><a href="Reddit.Auth.html#parseToken"><span class="hs-identifier hs-type">parseToken</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reddit.Auth.html#TokenInternal"><span class="hs-identifier hs-type">TokenInternal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Reddit.Auth.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-333"></span><span id="parseToken"><span class="annot"><span class="annottext">parseToken :: TokenInternal -&gt; IO Token
</span><a href="Reddit.Auth.html#parseToken"><span class="hs-identifier hs-var hs-var">parseToken</span></a></span></span><span> </span><span id="local-6989586621679102682"><span class="annot"><span class="annottext">TokenInternal
</span><a href="#local-6989586621679102682"><span class="hs-identifier hs-var">ti</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-334"></span><span>  </span><span id="local-6989586621679102681"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679102681"><span class="hs-identifier hs-var">currentTime</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO UTCTime
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/time-1.11.1.1/src"><span class="hs-identifier hs-var">getCurrentTime</span></a></span><span>
</span><span id="line-335"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679102679"><span class="annot"><span class="annottext">seconds :: NominalDiffTime
</span><a href="#local-6989586621679102679"><span class="hs-identifier hs-var hs-var">seconds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pico -&gt; NominalDiffTime
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/time-1.11.1.1/src"><span class="hs-identifier hs-var">secondsToNominalDiffTime</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (Real a, Fractional b) =&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">realToFrac</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TokenInternal -&gt; Int
</span><a href="Reddit.Auth.html#tknintExpiresIn"><span class="hs-identifier hs-var">tknintExpiresIn</span></a></span><span> </span><span class="annot"><span class="annottext">TokenInternal
</span><a href="#local-6989586621679102682"><span class="hs-identifier hs-var">ti</span></a></span><span>
</span><span id="line-336"></span><span>  </span><span class="hs-comment">-- Insert 10 second buffer time just in case there's lots of time between</span><span>
</span><span id="line-337"></span><span>  </span><span class="hs-comment">-- tokenInternal and currentTime being obtained.</span><span>
</span><span id="line-338"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679102677"><span class="annot"><span class="annottext">expiresAt :: UTCTime
</span><a href="#local-6989586621679102677"><span class="hs-identifier hs-var hs-var">expiresAt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; UTCTime -&gt; UTCTime
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/time-1.11.1.1/src"><span class="hs-identifier hs-var">addUTCTime</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="#local-6989586621679102679"><span class="hs-identifier hs-var">seconds</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679102681"><span class="hs-identifier hs-var">currentTime</span></a></span><span>
</span><span id="line-339"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-340"></span><span>    </span><span class="annot"><a href="Reddit.Auth.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-341"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">token :: ByteString
</span><a href="Reddit.Auth.html#token"><span class="hs-identifier hs-var">token</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-var">TE.encodeUtf8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TokenInternal -&gt; Text
</span><a href="Reddit.Auth.html#tknintToken"><span class="hs-identifier hs-var">tknintToken</span></a></span><span> </span><span class="annot"><span class="annottext">TokenInternal
</span><a href="#local-6989586621679102682"><span class="hs-identifier hs-var">ti</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-342"></span><span>        </span><span class="annot"><span class="annottext">tokenType :: ByteString
</span><a href="Reddit.Auth.html#tokenType"><span class="hs-identifier hs-var">tokenType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-var">TE.encodeUtf8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TokenInternal -&gt; Text
</span><a href="Reddit.Auth.html#tknintType"><span class="hs-identifier hs-var">tknintType</span></a></span><span> </span><span class="annot"><span class="annottext">TokenInternal
</span><a href="#local-6989586621679102682"><span class="hs-identifier hs-var">ti</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-343"></span><span>        </span><span class="annot"><span class="annottext">tokenScopes :: Set Scope
</span><a href="Reddit.Auth.html#tokenScopes"><span class="hs-identifier hs-var">tokenScopes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Set Scope
</span><a href="Reddit.Auth.html#parseScopes"><span class="hs-identifier hs-var">parseScopes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TokenInternal -&gt; Text
</span><a href="Reddit.Auth.html#tknintScopes"><span class="hs-identifier hs-var">tknintScopes</span></a></span><span> </span><span class="annot"><span class="annottext">TokenInternal
</span><a href="#local-6989586621679102682"><span class="hs-identifier hs-var">ti</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-344"></span><span>        </span><span class="annot"><span class="annottext">tokenExpiresAt :: UTCTime
</span><a href="Reddit.Auth.html#tokenExpiresAt"><span class="hs-identifier hs-var">tokenExpiresAt</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679102677"><span class="hs-identifier hs-var">expiresAt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-345"></span><span>        </span><span class="annot"><span class="annottext">tokenRefreshToken :: Maybe Text
</span><a href="Reddit.Auth.html#tokenRefreshToken"><span class="hs-identifier hs-var">tokenRefreshToken</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TokenInternal -&gt; Maybe Text
</span><a href="Reddit.Auth.html#tknintRefreshToken"><span class="hs-identifier hs-var">tknintRefreshToken</span></a></span><span> </span><span class="annot"><span class="annottext">TokenInternal
</span><a href="#local-6989586621679102682"><span class="hs-identifier hs-var">ti</span></a></span><span>
</span><span id="line-346"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span class="hs-comment">-- | Get a token using credentials. This is the core of 'Reddit.authenticate'.</span><span>
</span><span id="line-349"></span><span class="annot"><a href="Reddit.Auth.html#getToken"><span class="hs-identifier hs-type">getToken</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reddit.Auth.html#Credentials"><span class="hs-identifier hs-type">Credentials</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/bytestring-0.11.4.0/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Reddit.Auth.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span>
</span><span id="line-350"></span><span id="getToken"><span class="annot"><span class="annottext">getToken :: Credentials -&gt; ByteString -&gt; IO Token
</span><a href="Reddit.Auth.html#getToken"><span class="hs-identifier hs-var hs-var">getToken</span></a></span></span><span> </span><span id="local-6989586621679102675"><span class="annot"><span class="annottext">Credentials
</span><a href="#local-6989586621679102675"><span class="hs-identifier hs-var">creds</span></a></span></span><span> </span><span id="local-6989586621679102674"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679102674"><span class="hs-identifier hs-var">ua</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Credentials -&gt; ByteString -&gt; IO TokenInternal
</span><a href="Reddit.Auth.html#getTokenInternal"><span class="hs-identifier hs-var">getTokenInternal</span></a></span><span> </span><span class="annot"><span class="annottext">Credentials
</span><a href="#local-6989586621679102675"><span class="hs-identifier hs-var">creds</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679102674"><span class="hs-identifier hs-var">ua</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">TokenInternal -&gt; IO Token
</span><a href="Reddit.Auth.html#parseToken"><span class="hs-identifier hs-var">parseToken</span></a></span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span class="hs-comment">-- * Code flow ('authorisation code grant')</span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span class="hs-comment">-- | This should be chosen depending on whether your app needs a temporary token</span><span>
</span><span id="line-355"></span><span class="hs-comment">-- (i.e. user must authenticate again after the token expires), or a permanent</span><span>
</span><span id="line-356"></span><span class="hs-comment">-- one (i.e. user does not need to authenticate again).</span><span>
</span><span id="line-357"></span><span class="hs-comment">--</span><span>
</span><span id="line-358"></span><span class="hs-comment">-- Internally, permanent tokens are handled by requesting a refresh token when</span><span>
</span><span id="line-359"></span><span class="hs-comment">-- the existing one expires.</span><span>
</span><span id="line-360"></span><span class="hs-keyword">data</span><span> </span><span id="Duration"><span class="annot"><a href="Reddit.Auth.html#Duration"><span class="hs-identifier hs-var">Duration</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Temporary"><span class="annot"><a href="Reddit.Auth.html#Temporary"><span class="hs-identifier hs-var">Temporary</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Permanent"><span class="annot"><a href="Reddit.Auth.html#Permanent"><span class="hs-identifier hs-var">Permanent</span></a></span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679102668"><span id="local-6989586621679102670"><span class="annot"><span class="annottext">Duration -&gt; Duration -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Duration -&gt; Duration -&gt; Bool
$c/= :: Duration -&gt; Duration -&gt; Bool
== :: Duration -&gt; Duration -&gt; Bool
$c== :: Duration -&gt; Duration -&gt; Bool
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679102649"><span id="local-6989586621679102651"><span id="local-6989586621679102654"><span id="local-6989586621679102657"><span id="local-6989586621679102660"><span id="local-6989586621679102662"><span id="local-6989586621679102664"><span class="annot"><span class="annottext">Eq Duration
Duration -&gt; Duration -&gt; Bool
Duration -&gt; Duration -&gt; Ordering
Duration -&gt; Duration -&gt; Duration
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: Duration -&gt; Duration -&gt; Duration
$cmin :: Duration -&gt; Duration -&gt; Duration
max :: Duration -&gt; Duration -&gt; Duration
$cmax :: Duration -&gt; Duration -&gt; Duration
&gt;= :: Duration -&gt; Duration -&gt; Bool
$c&gt;= :: Duration -&gt; Duration -&gt; Bool
&gt; :: Duration -&gt; Duration -&gt; Bool
$c&gt; :: Duration -&gt; Duration -&gt; Bool
&lt;= :: Duration -&gt; Duration -&gt; Bool
$c&lt;= :: Duration -&gt; Duration -&gt; Bool
&lt; :: Duration -&gt; Duration -&gt; Bool
$c&lt; :: Duration -&gt; Duration -&gt; Bool
compare :: Duration -&gt; Duration -&gt; Ordering
$ccompare :: Duration -&gt; Duration -&gt; Ordering
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679102643"><span id="local-6989586621679102645"><span id="local-6989586621679102647"><span class="annot"><span class="annottext">Int -&gt; Duration -&gt; ShowS
[Duration] -&gt; ShowS
Duration -&gt; [Char]
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Duration] -&gt; ShowS
$cshowList :: [Duration] -&gt; ShowS
show :: Duration -&gt; [Char]
$cshow :: Duration -&gt; [Char]
showsPrec :: Int -&gt; Duration -&gt; ShowS
$cshowsPrec :: Int -&gt; Duration -&gt; ShowS
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-361"></span><span>
</span><span id="line-362"></span><span class="hs-comment">-- | The information required for your app to construct a link for the user to</span><span>
</span><span id="line-363"></span><span class="hs-comment">-- 'authorise with Reddit'.</span><span>
</span><span id="line-364"></span><span class="hs-comment">--</span><span>
</span><span id="line-365"></span><span class="hs-comment">-- This is only required for the 'code grant' flow.</span><span>
</span><span id="line-366"></span><span class="hs-keyword">data</span><span> </span><span id="AuthUrlParams"><span class="annot"><a href="Reddit.Auth.html#AuthUrlParams"><span class="hs-identifier hs-var">AuthUrlParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AuthUrlParams"><span class="annot"><a href="Reddit.Auth.html#AuthUrlParams"><span class="hs-identifier hs-var">AuthUrlParams</span></a></span></span><span>
</span><span id="line-367"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- | This is the client ID for your app.</span><span>
</span><span id="line-368"></span><span>    </span><span id="authUrlClientID"><span class="annot"><span class="annottext">AuthUrlParams -&gt; Text
</span><a href="Reddit.Auth.html#authUrlClientID"><span class="hs-identifier hs-var hs-var">authUrlClientID</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-369"></span><span>    </span><span class="hs-comment">-- | This can be any text value you want, and must be different for every</span><span>
</span><span id="line-370"></span><span>    </span><span class="hs-comment">-- user you are authenticating. If the user authorises your app, they will</span><span>
</span><span id="line-371"></span><span>    </span><span class="hs-comment">-- be sent back to your redirect URI, and the same state will be included as</span><span>
</span><span id="line-372"></span><span>    </span><span class="hs-comment">-- a query parameter. You should check that the returned state matches the</span><span>
</span><span id="line-373"></span><span>    </span><span class="hs-comment">-- one which you specified here.</span><span>
</span><span id="line-374"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-375"></span><span>    </span><span class="hs-comment">-- In principle, this is not mandatory. However, it is really bad practice</span><span>
</span><span id="line-376"></span><span>    </span><span class="hs-comment">-- to not use it, as it makes you vulnerable to CSRF attacks. See, e.g.,</span><span>
</span><span id="line-377"></span><span>    </span><span class="hs-comment">-- [Section 10.12 of the OAuth2</span><span>
</span><span id="line-378"></span><span>    </span><span class="hs-comment">-- RFC](https://datatracker.ietf.org/doc/html/rfc6749#section-10.12). So,</span><span>
</span><span id="line-379"></span><span>    </span><span class="hs-comment">-- this library forces you to specify it.</span><span>
</span><span id="line-380"></span><span>    </span><span id="authUrlState"><span class="annot"><span class="annottext">AuthUrlParams -&gt; Text
</span><a href="Reddit.Auth.html#authUrlState"><span class="hs-identifier hs-var hs-var">authUrlState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-381"></span><span>    </span><span class="hs-comment">-- | The URI which users will be sent back to after logging in. This must</span><span>
</span><span id="line-382"></span><span>    </span><span class="hs-comment">-- match the redirect URI set up in &lt;https://reddit.com/prefs/apps&gt;.</span><span>
</span><span id="line-383"></span><span>    </span><span id="authUrlRedirectUri"><span class="annot"><span class="annottext">AuthUrlParams -&gt; Text
</span><a href="Reddit.Auth.html#authUrlRedirectUri"><span class="hs-identifier hs-var hs-var">authUrlRedirectUri</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-384"></span><span>    </span><span class="hs-comment">-- | 'Temporary' or 'Permanent', depending on how long you need your user to</span><span>
</span><span id="line-385"></span><span>    </span><span class="hs-comment">-- be logged in for. Temporary tokens last for 1 hour, after which the user</span><span>
</span><span id="line-386"></span><span>    </span><span class="hs-comment">-- must re-authenticate if they want to continue using your app.</span><span>
</span><span id="line-387"></span><span>    </span><span id="authUrlDuration"><span class="annot"><span class="annottext">AuthUrlParams -&gt; Duration
</span><a href="Reddit.Auth.html#authUrlDuration"><span class="hs-identifier hs-var hs-var">authUrlDuration</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Reddit.Auth.html#Duration"><span class="hs-identifier hs-type">Duration</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-388"></span><span>    </span><span class="hs-comment">-- | The OAuth2 scopes that you need. This depends on what your app does on</span><span>
</span><span id="line-389"></span><span>    </span><span class="hs-comment">-- behalf of its users. See 'Scope' for the full list.</span><span>
</span><span id="line-390"></span><span>    </span><span id="authUrlScopes"><span class="annot"><span class="annottext">AuthUrlParams -&gt; Set Scope
</span><a href="Reddit.Auth.html#authUrlScopes"><span class="hs-identifier hs-var hs-var">authUrlScopes</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">S.Set</span></a></span><span> </span><span class="annot"><a href="Reddit.Auth.html#Scope"><span class="hs-identifier hs-type">Scope</span></a></span><span>
</span><span id="line-391"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span class="hs-comment">-- | Construct the Reddit authorisation URL that you should send your users to</span><span>
</span><span id="line-394"></span><span class="hs-comment">-- for the 'code grant' flow.</span><span>
</span><span id="line-395"></span><span class="annot"><a href="Reddit.Auth.html#mkRedditAuthURL"><span class="hs-identifier hs-type">mkRedditAuthURL</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-396"></span><span>  </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-397"></span><span>  </span><span class="hs-comment">-- | Whether to use the mobile version of the authorisation page</span><span>
</span><span id="line-398"></span><span>  </span><span class="annot"><a href="Reddit.Auth.html#AuthUrlParams"><span class="hs-identifier hs-type">AuthUrlParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-399"></span><span>  </span><span class="hs-comment">-- | The authorisation URL</span><span>
</span><span id="line-400"></span><span>  </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-401"></span><span id="mkRedditAuthURL"><span class="annot"><span class="annottext">mkRedditAuthURL :: Bool -&gt; AuthUrlParams -&gt; Text
</span><a href="Reddit.Auth.html#mkRedditAuthURL"><span class="hs-identifier hs-var hs-var">mkRedditAuthURL</span></a></span></span><span> </span><span id="local-6989586621679102636"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679102636"><span class="hs-identifier hs-var">mobile</span></a></span></span><span> </span><span id="local-6989586621679102635"><span class="annot"><span class="annottext">AuthUrlParams
</span><a href="#local-6989586621679102635"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-402"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679102634"><span class="annot"><span class="annottext">Maybe URI
</span><a href="#local-6989586621679102634"><span class="hs-identifier hs-var">maybeUri</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">URI.URI</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-403"></span><span>        </span><span id="local-6989586621679102633"><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679102633"><span class="hs-identifier hs-var">baseUri</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-404"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679102636"><span class="hs-identifier hs-var">mobile</span></a></span><span>
</span><span id="line-405"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadThrow m =&gt; Text -&gt; m URI
</span><span class="hs-identifier hs-var">URI.mkURI</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;https://www.reddit.com/api/v1/authorize.compact&quot;</span></span><span>
</span><span id="line-406"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadThrow m =&gt; Text -&gt; m URI
</span><span class="hs-identifier hs-var">URI.mkURI</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;https://www.reddit.com/api/v1/authorize&quot;</span></span><span>
</span><span id="line-407"></span><span>        </span><span id="local-6989586621679102631"><span class="annot"><span class="annottext">RText 'QueryKey
</span><a href="#local-6989586621679102631"><span class="hs-identifier hs-var">clientIDKey</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadThrow m =&gt; Text -&gt; m (RText 'QueryKey)
</span><span class="hs-identifier hs-var">URI.mkQueryKey</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;client_id&quot;</span></span><span>
</span><span id="line-408"></span><span>        </span><span id="local-6989586621679102629"><span class="annot"><span class="annottext">RText 'QueryValue
</span><a href="#local-6989586621679102629"><span class="hs-identifier hs-var">clientIDVal</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadThrow m =&gt; Text -&gt; m (RText 'QueryValue)
</span><span class="hs-identifier hs-var">URI.mkQueryValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AuthUrlParams -&gt; Text
</span><a href="Reddit.Auth.html#authUrlClientID"><span class="hs-identifier hs-var">authUrlClientID</span></a></span><span> </span><span class="annot"><span class="annottext">AuthUrlParams
</span><a href="#local-6989586621679102635"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>        </span><span id="local-6989586621679102627"><span class="annot"><span class="annottext">RText 'QueryKey
</span><a href="#local-6989586621679102627"><span class="hs-identifier hs-var">typeKey</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadThrow m =&gt; Text -&gt; m (RText 'QueryKey)
</span><span class="hs-identifier hs-var">URI.mkQueryKey</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;response_type&quot;</span></span><span>
</span><span id="line-410"></span><span>        </span><span id="local-6989586621679102626"><span class="annot"><span class="annottext">RText 'QueryValue
</span><a href="#local-6989586621679102626"><span class="hs-identifier hs-var">typeVal</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadThrow m =&gt; Text -&gt; m (RText 'QueryValue)
</span><span class="hs-identifier hs-var">URI.mkQueryValue</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;code&quot;</span></span><span>
</span><span id="line-411"></span><span>        </span><span id="local-6989586621679102625"><span class="annot"><span class="annottext">RText 'QueryKey
</span><a href="#local-6989586621679102625"><span class="hs-identifier hs-var">redirectKey</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadThrow m =&gt; Text -&gt; m (RText 'QueryKey)
</span><span class="hs-identifier hs-var">URI.mkQueryKey</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;redirect_uri&quot;</span></span><span>
</span><span id="line-412"></span><span>        </span><span id="local-6989586621679102624"><span class="annot"><span class="annottext">RText 'QueryValue
</span><a href="#local-6989586621679102624"><span class="hs-identifier hs-var">redirectVal</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadThrow m =&gt; Text -&gt; m (RText 'QueryValue)
</span><span class="hs-identifier hs-var">URI.mkQueryValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AuthUrlParams -&gt; Text
</span><a href="Reddit.Auth.html#authUrlRedirectUri"><span class="hs-identifier hs-var">authUrlRedirectUri</span></a></span><span> </span><span class="annot"><span class="annottext">AuthUrlParams
</span><a href="#local-6989586621679102635"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-413"></span><span>        </span><span id="local-6989586621679102623"><span class="annot"><span class="annottext">RText 'QueryKey
</span><a href="#local-6989586621679102623"><span class="hs-identifier hs-var">durationKey</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadThrow m =&gt; Text -&gt; m (RText 'QueryKey)
</span><span class="hs-identifier hs-var">URI.mkQueryKey</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;duration&quot;</span></span><span>
</span><span id="line-414"></span><span>        </span><span id="local-6989586621679102622"><span class="annot"><span class="annottext">RText 'QueryValue
</span><a href="#local-6989586621679102622"><span class="hs-identifier hs-var">durationVal</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadThrow m =&gt; Text -&gt; m (RText 'QueryValue)
</span><span class="hs-identifier hs-var">URI.mkQueryValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-var">T.toLower</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Text
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; [Char]
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AuthUrlParams -&gt; Duration
</span><a href="Reddit.Auth.html#authUrlDuration"><span class="hs-identifier hs-var">authUrlDuration</span></a></span><span> </span><span class="annot"><span class="annottext">AuthUrlParams
</span><a href="#local-6989586621679102635"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-415"></span><span>        </span><span id="local-6989586621679102618"><span class="annot"><span class="annottext">RText 'QueryKey
</span><a href="#local-6989586621679102618"><span class="hs-identifier hs-var">scopeKey</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadThrow m =&gt; Text -&gt; m (RText 'QueryKey)
</span><span class="hs-identifier hs-var">URI.mkQueryKey</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;scope&quot;</span></span><span>
</span><span id="line-416"></span><span>        </span><span id="local-6989586621679102617"><span class="annot"><span class="annottext">RText 'QueryValue
</span><a href="#local-6989586621679102617"><span class="hs-identifier hs-var">scopeVal</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadThrow m =&gt; Text -&gt; m (RText 'QueryValue)
</span><span class="hs-identifier hs-var">URI.mkQueryValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Scope -&gt; Text
</span><a href="Reddit.Auth.html#showScopes"><span class="hs-identifier hs-var">showScopes</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AuthUrlParams -&gt; Set Scope
</span><a href="Reddit.Auth.html#authUrlScopes"><span class="hs-identifier hs-var">authUrlScopes</span></a></span><span> </span><span class="annot"><span class="annottext">AuthUrlParams
</span><a href="#local-6989586621679102635"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-417"></span><span>        </span><span id="local-6989586621679102616"><span class="annot"><span class="annottext">RText 'QueryKey
</span><a href="#local-6989586621679102616"><span class="hs-identifier hs-var">stateKey</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadThrow m =&gt; Text -&gt; m (RText 'QueryKey)
</span><span class="hs-identifier hs-var">URI.mkQueryKey</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;state&quot;</span></span><span>
</span><span id="line-418"></span><span>        </span><span id="local-6989586621679102615"><span class="annot"><span class="annottext">RText 'QueryValue
</span><a href="#local-6989586621679102615"><span class="hs-identifier hs-var">stateVal</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadThrow m =&gt; Text -&gt; m (RText 'QueryValue)
</span><span class="hs-identifier hs-var">URI.mkQueryValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AuthUrlParams -&gt; Text
</span><a href="Reddit.Auth.html#authUrlState"><span class="hs-identifier hs-var">authUrlState</span></a></span><span> </span><span class="annot"><span class="annottext">AuthUrlParams
</span><a href="#local-6989586621679102635"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-419"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679102614"><span class="annot"><span class="annottext">params :: [QueryParam]
</span><a href="#local-6989586621679102614"><span class="hs-identifier hs-var hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-420"></span><span>              </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">RText 'QueryKey -&gt; RText 'QueryValue -&gt; QueryParam
</span><span class="hs-identifier hs-var">URI.QueryParam</span></span><span> </span><span class="annot"><span class="annottext">RText 'QueryKey
</span><a href="#local-6989586621679102631"><span class="hs-identifier hs-var">clientIDKey</span></a></span><span> </span><span class="annot"><span class="annottext">RText 'QueryValue
</span><a href="#local-6989586621679102629"><span class="hs-identifier hs-var">clientIDVal</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-421"></span><span>                </span><span class="annot"><span class="annottext">RText 'QueryKey -&gt; RText 'QueryValue -&gt; QueryParam
</span><span class="hs-identifier hs-var">URI.QueryParam</span></span><span> </span><span class="annot"><span class="annottext">RText 'QueryKey
</span><a href="#local-6989586621679102627"><span class="hs-identifier hs-var">typeKey</span></a></span><span> </span><span class="annot"><span class="annottext">RText 'QueryValue
</span><a href="#local-6989586621679102626"><span class="hs-identifier hs-var">typeVal</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-422"></span><span>                </span><span class="annot"><span class="annottext">RText 'QueryKey -&gt; RText 'QueryValue -&gt; QueryParam
</span><span class="hs-identifier hs-var">URI.QueryParam</span></span><span> </span><span class="annot"><span class="annottext">RText 'QueryKey
</span><a href="#local-6989586621679102625"><span class="hs-identifier hs-var">redirectKey</span></a></span><span> </span><span class="annot"><span class="annottext">RText 'QueryValue
</span><a href="#local-6989586621679102624"><span class="hs-identifier hs-var">redirectVal</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-423"></span><span>                </span><span class="annot"><span class="annottext">RText 'QueryKey -&gt; RText 'QueryValue -&gt; QueryParam
</span><span class="hs-identifier hs-var">URI.QueryParam</span></span><span> </span><span class="annot"><span class="annottext">RText 'QueryKey
</span><a href="#local-6989586621679102623"><span class="hs-identifier hs-var">durationKey</span></a></span><span> </span><span class="annot"><span class="annottext">RText 'QueryValue
</span><a href="#local-6989586621679102622"><span class="hs-identifier hs-var">durationVal</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-424"></span><span>                </span><span class="annot"><span class="annottext">RText 'QueryKey -&gt; RText 'QueryValue -&gt; QueryParam
</span><span class="hs-identifier hs-var">URI.QueryParam</span></span><span> </span><span class="annot"><span class="annottext">RText 'QueryKey
</span><a href="#local-6989586621679102618"><span class="hs-identifier hs-var">scopeKey</span></a></span><span> </span><span class="annot"><span class="annottext">RText 'QueryValue
</span><a href="#local-6989586621679102617"><span class="hs-identifier hs-var">scopeVal</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-425"></span><span>                </span><span class="annot"><span class="annottext">RText 'QueryKey -&gt; RText 'QueryValue -&gt; QueryParam
</span><span class="hs-identifier hs-var">URI.QueryParam</span></span><span> </span><span class="annot"><span class="annottext">RText 'QueryKey
</span><a href="#local-6989586621679102616"><span class="hs-identifier hs-var">stateKey</span></a></span><span> </span><span class="annot"><span class="annottext">RText 'QueryValue
</span><a href="#local-6989586621679102615"><span class="hs-identifier hs-var">stateVal</span></a></span><span>
</span><span id="line-426"></span><span>              </span><span class="hs-special">]</span><span>
</span><span id="line-427"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679102633"><span class="hs-identifier hs-var">baseUri</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">uriQuery :: [QueryParam]
</span><span class="hs-identifier hs-var">URI.uriQuery</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[QueryParam]
</span><a href="#local-6989586621679102614"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-428"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe URI
</span><a href="#local-6989586621679102634"><span class="hs-identifier hs-var">maybeUri</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-429"></span><span>        </span><span class="annot"><span class="annottext">Maybe URI
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;mkRedditAuthURL failed&quot;</span></span><span>
</span><span id="line-430"></span><span>        </span><span class="annot"><a href="../file:///usr/local/.ghcup/ghc/9.2.8/share/doc/ghc-9.2.8/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679102610"><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679102610"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">URI -&gt; Text
</span><span class="hs-identifier hs-var">URI.render</span></span><span> </span><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679102610"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-431"></span></pre></body></html>